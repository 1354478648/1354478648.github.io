<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"1354478648.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="黑马最近新上了一套关于 SpringBoot3 和 Vue3 的课程，想着明年也是要写毕业论文了，就抓紧过来学习学习  课程地址：https:&#x2F;&#x2F;www.bilibili.com&#x2F;video&#x2F;BV14z4y1N7pg">
<meta property="og:type" content="article">
<meta property="og:title" content="SpringBoot和Vue的全栈开发教程">
<meta property="og:url" content="http://1354478648.github.io/2023/11/10/SpringBoot%E5%92%8CVue%E7%9A%84%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91%E6%95%99%E7%A8%8B/index.html">
<meta property="og:site_name" content="糖泥的个人博客">
<meta property="og:description" content="黑马最近新上了一套关于 SpringBoot3 和 Vue3 的课程，想着明年也是要写毕业论文了，就抓紧过来学习学习  课程地址：https:&#x2F;&#x2F;www.bilibili.com&#x2F;video&#x2F;BV14z4y1N7pg">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://1354478648.github.io/images/SpringBoot%E5%92%8CVue%E7%9A%84%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91%E6%95%99%E7%A8%8B/%E5%B7%A5%E7%A8%8B%E5%88%9B%E5%BB%BA1.png">
<meta property="og:image" content="http://1354478648.github.io/images/SpringBoot%E5%92%8CVue%E7%9A%84%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91%E6%95%99%E7%A8%8B/%E5%B7%A5%E7%A8%8B%E5%88%9B%E5%BB%BA2.png">
<meta property="article:published_time" content="2023-11-10T02:05:28.000Z">
<meta property="article:modified_time" content="2023-12-07T06:11:54.814Z">
<meta property="article:author" content="Downey">
<meta property="article:tag" content="前端">
<meta property="article:tag" content="后端">
<meta property="article:tag" content="Java">
<meta property="article:tag" content="Spring">
<meta property="article:tag" content="Vue">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://1354478648.github.io/images/SpringBoot%E5%92%8CVue%E7%9A%84%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91%E6%95%99%E7%A8%8B/%E5%B7%A5%E7%A8%8B%E5%88%9B%E5%BB%BA1.png">

<link rel="canonical" href="http://1354478648.github.io/2023/11/10/SpringBoot%E5%92%8CVue%E7%9A%84%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91%E6%95%99%E7%A8%8B/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>SpringBoot和Vue的全栈开发教程 | 糖泥的个人博客</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">糖泥的个人博客</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">欢迎！ Welcome!</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://1354478648.github.io/2023/11/10/SpringBoot%E5%92%8CVue%E7%9A%84%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91%E6%95%99%E7%A8%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Downey">
      <meta itemprop="description" content="大杯牛乳红茶 去冰 三分糖">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="糖泥的个人博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          SpringBoot和Vue的全栈开发教程
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-11-10 10:05:28" itemprop="dateCreated datePublished" datetime="2023-11-10T10:05:28+08:00">2023-11-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-12-07 14:11:54" itemprop="dateModified" datetime="2023-12-07T14:11:54+08:00">2023-12-07</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%90%8E%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">后端</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span><br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>83k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>2:31</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>黑马最近新上了一套关于 SpringBoot3 和 Vue3
的课程，想着明年也是要写毕业论文了，就抓紧过来学习学习</p>
<blockquote>
<p>课程地址：https://www.bilibili.com/video/BV14z4y1N7pg</p>
</blockquote>
<span id="more"></span>
<h2 id="复习一下后端">复习一下后端</h2>
<h3 id="springboot工程创建">SpringBoot工程创建</h3>
<ol type="1">
<li>新建项目，选择<code>Spring Initializr</code>，修改项目名称、文件路径等信息</li>
</ol>
<p><img src="\images\SpringBoot和Vue的全栈开发教程\工程创建1.png" width="80%" height="auto"></p>
<p>注意，SpringBoot 需要版本为17 的 JDK 和 Java</p>
<ol start="2" type="1">
<li>SpringBoot 项目选择3.0以上的版本，然后在起步依赖中勾选 Spring
Web</li>
</ol>
<p><img src="\images\SpringBoot和Vue的全栈开发教程\工程创建2.png" width="80%" height="auto"></p>
<ol start="3" type="1">
<li><p>编写控制类 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/hello&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">hello</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Hello, World!&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Hello, World!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></li>
<li><p>运行启动类</p></li>
</ol>
<h3 id="配置文件">配置文件</h3>
<p>SpringBoot 提供了多种属性配置方式，其中最常用的是 yml 文件格式 - 将
application.properties 修改为 .yml 文件后，尝试输入以下配置：
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8081</span></span><br><span class="line">  <span class="attr">servlet:</span></span><br><span class="line">    <span class="attr">context-path:</span> <span class="string">/start</span></span><br></pre></td></tr></table></figure>
该配置修改了项目的启动端口和虚拟路径，在浏览器访问的时候需要输入<code>http://localhost:8081/start/</code></p>
<ul>
<li>配置文件中通常存在三方技术的配置信息和自定义配置信息，三方技术的配置信息可以参考技术提供者编写的文档等，而自定义配置信息需要以下步骤进行书写与获取：</li>
</ul>
<ol type="1">
<li><p>比如在配置文件中自定义邮件的发送信息，注意添加前缀防止键名冲突
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">email:</span></span><br><span class="line">  <span class="attr">user:</span> <span class="string">XXX@qq.com</span></span><br><span class="line">  <span class="attr">code:</span> <span class="string">XXX</span></span><br><span class="line">  <span class="attr">host:</span> <span class="string">smtp.qq.com</span></span><br><span class="line">  <span class="attr">auth:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 数组类型</span></span><br><span class="line"><span class="attr">hobbies:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">打篮球</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">打游戏</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">打豆豆</span></span><br></pre></td></tr></table></figure></p></li>
<li><p>在实体类的成员属性上使用<code>@Value("$&#123;键名&#125;")</code>，比如<code>@Value("$&#123;email.user&#125;")</code>；</p>
<p>或者在类名上<code>@ConfigurationProperties(prefix="前缀")</code>，比如<code>@ConfigurationProperties(prefix="email")</code>，但是前提是实体类的成员变量名与配置文件中的键名需要保持一致</p></li>
</ol>
<h3 id="整合mybatis">整合MyBatis</h3>
<ol type="1">
<li><p>引入 MyBatis 和 MySQL的坐标 <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- MySQL 驱动依赖 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.31<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- MyBatis 起步依赖 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></p></li>
<li><p>在配置文件中配置数据源信息 <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/mybatis</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="number">2002</span></span><br></pre></td></tr></table></figure></p></li>
</ol>
<h2 id="大事件项目开发">大事件项目开发</h2>
<h3 id="用户相关接口">用户相关接口</h3>
<h4 id="注册">注册</h4>
<ol type="1">
<li><p>添加 lombok 起步依赖 <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- lombok依赖 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></p></li>
<li><p>编写用户实体类 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;<span class="comment">//主键ID</span></span><br><span class="line">    <span class="keyword">private</span> String username;<span class="comment">//用户名</span></span><br><span class="line">    <span class="keyword">private</span> String password;<span class="comment">//密码</span></span><br><span class="line">    <span class="keyword">private</span> String nickname;<span class="comment">//昵称</span></span><br><span class="line">    <span class="keyword">private</span> String email;<span class="comment">//邮箱</span></span><br><span class="line">    <span class="keyword">private</span> String userPic;<span class="comment">//用户头像地址</span></span><br><span class="line">    <span class="keyword">private</span> LocalDateTime createTime;<span class="comment">//创建时间</span></span><br><span class="line">    <span class="keyword">private</span> LocalDateTime updateTime;<span class="comment">//更新时间</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></li>
<li><p>编写通用返回结果类<code>Result</code>
注意，其中<code>return new Result&lt;&gt;(0, "操作成功", data);</code>等返回语句是使用了有参构造方法实例化对象，因此需要使用<code>@AllArgsConstructor</code>注解自动地生成有参构造方法。<code>@Data</code>注解不包括自动生成无参和有参构造
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//统一响应结果</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Result</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> Integer code;<span class="comment">//业务状态码  0-成功  1-失败</span></span><br><span class="line">    <span class="keyword">private</span> String message;<span class="comment">//提示信息</span></span><br><span class="line">    <span class="keyword">private</span> T data;<span class="comment">//响应数据</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//快速返回操作成功响应结果(带响应数据)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;E&gt; Result&lt;E&gt; <span class="title function_">success</span><span class="params">(E data)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Result</span>&lt;&gt;(<span class="number">0</span>, <span class="string">&quot;操作成功&quot;</span>, data);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//快速返回操作成功响应结果</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Result <span class="title function_">success</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Result</span>(<span class="number">0</span>, <span class="string">&quot;操作成功&quot;</span>, <span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Result <span class="title function_">error</span><span class="params">(String message)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Result</span>(<span class="number">1</span>, message, <span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></li>
<li><p>编写<code>UserController</code>并实现注册方法
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/user&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/register&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">register</span><span class="params">(String username, String password)</span>&#123;</span><br><span class="line">        <span class="comment">// 1.查询用户</span></span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userService.findByUsername(username);</span><br><span class="line">        <span class="keyword">if</span>(user == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="comment">//用户名未占用，则进行注册</span></span><br><span class="line">            userService.register(username, password);</span><br><span class="line">            <span class="keyword">return</span> Result.success();</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="comment">//用户名已占用，则返回错误</span></span><br><span class="line">            <span class="keyword">return</span> Result.error(<span class="string">&quot;用户名已被占用&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></li>
<li><p>编写<code>UserService</code>和<code>UserServiceImpl</code>，并提供接口
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//根据用户名查询用户</span></span><br><span class="line">    User <span class="title function_">findByUsername</span><span class="params">(String username)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//用户注册</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">register</span><span class="params">(String username, String password)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">findByUsername</span><span class="params">(String username)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userMapper.findByUsername(username);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">register</span><span class="params">(String username, String password)</span> &#123;</span><br><span class="line">        <span class="comment">//密码加密</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">md5String</span> <span class="operator">=</span> Md5Util.getMD5String(password);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//添加用户</span></span><br><span class="line">        userMapper.add(username, md5String);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
注意，这里是我们自己提供的MD5加密工具类，也可以使用Spring提供的工具类
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Md5Util</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 默认的密码字符串组合，用来将字节转换成 16 进制表示的字符,apache校验下载的文件的正确性用的就是默认的这个组合</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">static</span> <span class="type">char</span> hexDigits[] = &#123;<span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;8&#x27;</span>, <span class="string">&#x27;9&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;f&#x27;</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">static</span> <span class="type">MessageDigest</span> <span class="variable">messagedigest</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            messagedigest = MessageDigest.getInstance(<span class="string">&quot;MD5&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchAlgorithmException nsaex) &#123;</span><br><span class="line">            System.err.println(Md5Util.class.getName() + <span class="string">&quot;初始化失败，MessageDigest不支持MD5Util。&quot;</span>);</span><br><span class="line">            nsaex.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 生成字符串的md5校验值</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> s</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">getMD5String</span><span class="params">(String s)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> getMD5String(s.getBytes());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 判断字符串的md5校验码是否与一个已知的md5码相匹配</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> password  要校验的字符串</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> md5PwdStr 已知的md5校验码</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">checkPassword</span><span class="params">(String password, String md5PwdStr)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> getMD5String(password);</span><br><span class="line">        <span class="keyword">return</span> s.equals(md5PwdStr);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">getMD5String</span><span class="params">(<span class="type">byte</span>[] bytes)</span> &#123;</span><br><span class="line">        messagedigest.update(bytes);</span><br><span class="line">        <span class="keyword">return</span> bufferToHex(messagedigest.digest());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String <span class="title function_">bufferToHex</span><span class="params">(<span class="type">byte</span> bytes[])</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> bufferToHex(bytes, <span class="number">0</span>, bytes.length);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String <span class="title function_">bufferToHex</span><span class="params">(<span class="type">byte</span> bytes[], <span class="type">int</span> m, <span class="type">int</span> n)</span> &#123;</span><br><span class="line">        <span class="type">StringBuffer</span> <span class="variable">stringbuffer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>(<span class="number">2</span> * n);</span><br><span class="line">        <span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> m + n;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">l</span> <span class="operator">=</span> m; l &lt; k; l++) &#123;</span><br><span class="line">            appendHexPair(bytes[l], stringbuffer);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> stringbuffer.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">appendHexPair</span><span class="params">(<span class="type">byte</span> bt, StringBuffer stringbuffer)</span> &#123;</span><br><span class="line">        <span class="type">char</span> <span class="variable">c0</span> <span class="operator">=</span> hexDigits[(bt &amp; <span class="number">0xf0</span>) &gt;&gt; <span class="number">4</span>];<span class="comment">// 取字节中高 4 位的数字转换, &gt;&gt;&gt;</span></span><br><span class="line">        <span class="comment">// 为逻辑右移，将符号位一起右移,此处未发现两种符号有何不同</span></span><br><span class="line">        <span class="type">char</span> <span class="variable">c1</span> <span class="operator">=</span> hexDigits[bt &amp; <span class="number">0xf</span>];<span class="comment">// 取字节中低 4 位的数字转换</span></span><br><span class="line">        stringbuffer.append(c0);</span><br><span class="line">        stringbuffer.append(c1);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">password = DigestUtils.md5DigestAsHex(password.getBytes());</span><br></pre></td></tr></table></figure></p></li>
<li><p>编写<code>UserMapper</code>，并编写SQL语句 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserMapper</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//根据用户名查询用户</span></span><br><span class="line">    <span class="meta">@Select(&quot;select * from user where username = #&#123;username&#125;&quot;)</span></span><br><span class="line">    User <span class="title function_">findByUsername</span><span class="params">(String username)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//添加用户</span></span><br><span class="line">    <span class="meta">@Insert(&quot;insert into user(username, password, create_time, update_time)&quot; +</span></span><br><span class="line"><span class="meta">            &quot;values(#&#123;username&#125;, #&#123;password&#125;, now(), now())&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(String username, String password)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure> #####
Spring Validation参数校验</p></li>
<li><p>引入Spring Validation依赖 <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Spring Validation --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-validation<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></p></li>
<li><p>在需要参数校验的控制类上添加<code>@Validated</code>注解
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Validated</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br></pre></td></tr></table></figure></p></li>
<li><p>在需要参数校验的形参前添加<code>@Pattern</code>注解，并在<code>regexp</code>参数中添加正则表达式
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Result <span class="title function_">register</span><span class="params">(<span class="meta">@Pattern(regexp = &quot;^\\S&#123;5,16&#125;$&quot;)</span> String username, <span class="meta">@Pattern(regexp = &quot;^\\S&#123;5,16&#125;$&quot;)</span>String password)</span>&#123;</span><br></pre></td></tr></table></figure></p></li>
<li><p>如果此时我们进行测试，我们会发现返回的是500异常信息，并不符合接口开发的约定，因此我们需要全局异常处理器，将异常信息封装为结果类对象的JSON字符串返回给前端
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GlobalExceptionHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExceptionHandler</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">handlerException</span><span class="params">(Exception e)</span>&#123;</span><br><span class="line">        <span class="comment">//打印异常的堆栈信息</span></span><br><span class="line">        e.printStackTrace();</span><br><span class="line">        <span class="comment">//有些异常可能没有具体信息，需要判断</span></span><br><span class="line">        <span class="keyword">return</span> Result.error(StringUtils.hasLength(e.getMessage())? e.getMessage() : <span class="string">&quot;操作失败&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></li>
</ol>
<h4 id="登录">登录</h4>
<ol type="1">
<li>在<code>UserController</code>中实现基本登录方法 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/login&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result&lt;String&gt; <span class="title function_">login</span><span class="params">(<span class="meta">@Pattern(regexp = &quot;^\\S&#123;5,16&#125;$&quot;)</span> String username, <span class="meta">@Pattern(regexp = &quot;^\\S&#123;5,16&#125;$&quot;)</span>String password)</span>&#123;</span><br><span class="line">    <span class="comment">//根据用户名查询用户</span></span><br><span class="line">    <span class="type">User</span> <span class="variable">loginUser</span> <span class="operator">=</span> userService.findByUsername(username);</span><br><span class="line">    <span class="comment">//判断用户是否存在</span></span><br><span class="line">    <span class="keyword">if</span>(loginUser == <span class="literal">null</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> Result.error(<span class="string">&quot;用户名错误&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//判断密码是否正确</span></span><br><span class="line">    <span class="keyword">if</span> (Md5Util.getMD5String(password).equals(loginUser.getPassword())) &#123;</span><br><span class="line">        <span class="comment">//登录成功</span></span><br><span class="line">        <span class="keyword">return</span> Result.success(<span class="string">&quot;jwt token令牌&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> Result.error(<span class="string">&quot;密码错误&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h5 id="jwt详解">JWT详解</h5>
<p>JWT令牌就是一段字符串，用于承载业务数据，减少后续请求查询数据库的次数，同时防篡改，保证信息的合法性和有效性
组成： 1.
第一部分：Header（头），记录令牌类型、签名算法等。例如<code>&#123;"alg":"HS256","type":"JWT"&#125;</code>
2.
第二部分：Payload（有效载荷），携带一些自定义信息、默认信息等。例如<code>&#123;"id":"1","username":"Tom"&#125;</code>
3.
第三部分：Signature（签名），防止Token被篡改、确保安全性。将header、payload，并加入指定秘钥，通过指定签名算法计算而来</p>
<p>我们需要把业务重点放在令牌的<strong>生成</strong>和<strong>验证</strong>上，下面通过单元测试解释两个流程：
1. 引入JWT依赖、单元测试依赖 <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- java jwt --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.auth0<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>java-jwt<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>4.4.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure> <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 单元测试 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure> 2.
编写测试生成的代码 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testGen</span><span class="params">()</span>&#123;</span><br><span class="line">    Map&lt;String,Object&gt; claims = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    claims.put(<span class="string">&quot;id&quot;</span>, <span class="number">1</span>);</span><br><span class="line">    claims.put(<span class="string">&quot;username&quot;</span>, <span class="string">&quot;张三&quot;</span>);</span><br><span class="line">    <span class="comment">//生成jwt</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> JWT.create()</span><br><span class="line">            .withClaim(<span class="string">&quot;user&quot;</span>, claims) <span class="comment">//添加载荷</span></span><br><span class="line">            .withExpiresAt(<span class="keyword">new</span> <span class="title class_">Date</span>(System.currentTimeMillis() + <span class="number">1000</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">12</span>)) <span class="comment">//添加过期时间</span></span><br><span class="line">            .sign(Algorithm.HMAC256(<span class="string">&quot;sues&quot;</span>)); <span class="comment">//指定算法，配置秘钥</span></span><br><span class="line">    System.out.println(token);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure> 3. 编写测试验证的代码
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testParse</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="comment">//定义字符串，模拟用户传递过来的字符串</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> <span class="string">&quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjp7ImlkIjoxLCJ1c2VybmFtZSI6IuW8oOS4iSJ9LCJleHAiOjE2OTk4ODQzNzJ9.DNJn2YUBZWTLReGbIjGLBvwV0cnM_W_s0YkadcL-iug&quot;</span>;</span><br><span class="line">    <span class="type">JWTVerifier</span> <span class="variable">jwtVerifier</span> <span class="operator">=</span> JWT.require(Algorithm.HMAC256(<span class="string">&quot;sues&quot;</span>)).build(); <span class="comment">//创建一个JWT解析器</span></span><br><span class="line">    <span class="type">DecodedJWT</span> <span class="variable">decodedJWT</span> <span class="operator">=</span> jwtVerifier.verify(token); <span class="comment">//验证token，生成一个解析后的JWT对象</span></span><br><span class="line">    Map&lt;String, Claim&gt; claims = decodedJWT.getClaims(); <span class="comment">//获取载荷</span></span><br><span class="line">    System.out.println(claims);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h5 id="登录认证">登录认证</h5>
<ol type="1">
<li>导入JWT工具类 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JwtUtil</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">KEY</span> <span class="operator">=</span> <span class="string">&quot;sues&quot;</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//接收业务数据,生成token并返回</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">genToken</span><span class="params">(Map&lt;String, Object&gt; claims)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> JWT.create()</span><br><span class="line">                .withClaim(<span class="string">&quot;claims&quot;</span>, claims)</span><br><span class="line">                .withExpiresAt(<span class="keyword">new</span> <span class="title class_">Date</span>(System.currentTimeMillis() + <span class="number">1000</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">12</span>))</span><br><span class="line">                .sign(Algorithm.HMAC256(KEY));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//接收token,验证token,并返回业务数据</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String, Object&gt; <span class="title function_">parseToken</span><span class="params">(String token)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> JWT.require(Algorithm.HMAC256(KEY))</span><br><span class="line">                .build()</span><br><span class="line">                .verify(token)</span><br><span class="line">                .getClaim(<span class="string">&quot;claims&quot;</span>)</span><br><span class="line">                .asMap();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>在用户登录方法中添加生成token的代码 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//判断密码是否正确</span></span><br><span class="line"><span class="keyword">if</span> (Md5Util.getMD5String(password).equals(loginUser.getPassword())) &#123;</span><br><span class="line">    <span class="comment">//登录成功</span></span><br><span class="line">    <span class="comment">//将id和username放进载荷中</span></span><br><span class="line">    Map&lt;String, Object&gt; claims = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    claims.put(<span class="string">&quot;id&quot;</span>, loginUser.getId());</span><br><span class="line">    claims.put(<span class="string">&quot;username&quot;</span>, loginUser.getUsername());</span><br><span class="line">    <span class="comment">//将载荷和其他固定的加密信息生成token</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> JwtUtil.genToken(claims);</span><br><span class="line">    <span class="keyword">return</span> Result.success(token);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>编写<code>LoginInterceptor</code>拦截器，重写<code>preHandle</code>方法，验证token的合法性
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginInterceptor</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">//令牌验证</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> request.getHeader(<span class="string">&quot;Authorization&quot;</span>);</span><br><span class="line">        <span class="comment">//验证token</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Map&lt;String, Object&gt; claims = JwtUtil.parseToken(token);</span><br><span class="line">            <span class="comment">//放行</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            <span class="comment">//http响应状态码为401</span></span><br><span class="line">            response.setStatus(<span class="number">401</span>);</span><br><span class="line">            <span class="comment">//不放行</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>编写<code>WebConfig</code>注册拦截器 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebConfig</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> LoginInterceptor loginInterceptor;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> &#123;</span><br><span class="line">        <span class="comment">//登录接口和注册接口不拦截</span></span><br><span class="line">        registry.addInterceptor(loginInterceptor).excludePathPatterns(<span class="string">&quot;/user/login&quot;</span>, <span class="string">&quot;/user/register&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="获取用户详细信息">获取用户详细信息</h4>
<ol type="1">
<li>在<code>UserController</code>中实现方法 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/userInfo&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;User&gt; <span class="title function_">userInfo</span><span class="params">(<span class="meta">@RequestHeader(name = &quot;Authorization&quot;)</span>String token)</span>&#123;</span><br><span class="line">        <span class="comment">//根据用户名查询用户</span></span><br><span class="line">        Map&lt;String, Object&gt; map = JwtUtil.parseToken(token);</span><br><span class="line">        <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> (String) map.get(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userService.findByUsername(username);</span><br><span class="line">        <span class="keyword">return</span> Result.success(user);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li>
<li>我们可以在Postman中的collection的Pre-request中预定义一些内容，避免每次需要在请求头中修改token
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pm.<span class="property">request</span>.<span class="title function_">addHeader</span>(<span class="string">&quot;Authorization:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJjbGFpbXMiOnsiaWQiOjIsInVzZXJuYW1lIjoid2FuZ2JhIn0sImV4cCI6MTY5OTg5NzUwMX0._6--dUMo_zpZOFeOTn29Eqs0zZe3YrQDtt9g9QrpPy8&quot;</span>)</span><br></pre></td></tr></table></figure></li>
<li>观察返回的结果，我们需要避免出现密码这类敏感信息，在用户实体类中添加注解
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@JsonIgnore</span> <span class="comment">//把当前对象转为json字符串时忽略密码</span></span><br><span class="line"><span class="keyword">private</span> String password;<span class="comment">//密码</span></span><br></pre></td></tr></table></figure></li>
<li>在返回结果中创建时间和更新时间也没有值，是因为数据库中的字段名和属性名没有对应上，我们需要在配置文件中添加驼峰命名和下划线命名的转换
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">mybatis:</span></span><br><span class="line">  <span class="attr">configuration:</span></span><br><span class="line">    <span class="attr">map-underscore-to-camel-case:</span> <span class="literal">true</span> <span class="comment">#开启驼峰命名和下划线命名的转换</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h5 id="threadlocal优化">Threadlocal优化</h5>
<p>为了避免每次都需要验证token和在形参中写一长串代码，我们可以将数据存放进ThreadLocal中，每位用户在访问系统的时候，Tomcat都会单独为每位用户开辟一个线程，每个线程的ThreadLocal都能保证线程安全。
ThreadLocal用于存储数据：<code>set()</code>和<code>get()</code>；使用ThreadLocal存储的数据，线程安全；用完需要调用<code>remove()</code>方法释放
1. 导入ThreadLocal工具类 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ThreadLocal 工具类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@SuppressWarnings(&quot;all&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ThreadLocalUtil</span> &#123;</span><br><span class="line">    <span class="comment">//提供ThreadLocal对象</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">ThreadLocal</span> <span class="variable">THREAD_LOCAL</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ThreadLocal</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//根据键获取值</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; T <span class="title function_">get</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (T) THREAD_LOCAL.get();</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">//存储键值对</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">set</span><span class="params">(Object value)</span>&#123;</span><br><span class="line">        THREAD_LOCAL.set(value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//清除ThreadLocal 防止内存泄漏</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">remove</span><span class="params">()</span>&#123;</span><br><span class="line">        THREAD_LOCAL.remove();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure> 2.
在<code>LoginIntercepter</code>中将业务数据存储到ThreadLocal中
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="comment">//令牌验证</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> request.getHeader(<span class="string">&quot;Authorization&quot;</span>);</span><br><span class="line">    <span class="comment">//验证token</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Map&lt;String, Object&gt; claims = JwtUtil.parseToken(token);</span><br><span class="line">        <span class="comment">//将业务数据存储到ThreadLocal中</span></span><br><span class="line">        ThreadLocalUtil.set(claims);</span><br><span class="line">        <span class="comment">//放行</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">        <span class="comment">//http响应状态码为401</span></span><br><span class="line">        response.setStatus(<span class="number">401</span>);</span><br><span class="line">        <span class="comment">//不放行</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure> 3.
重写<code>afterCompletion</code>方法，清除ThreadLocal的变量
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="comment">//清空ThreadLocal中的数据</span></span><br><span class="line">    ThreadLocalUtil.remove();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure> 4. 在<code>UserController</code>中通过ThreadLocal获取值
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/userInfo&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result&lt;User&gt; <span class="title function_">userInfo</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="comment">//根据用户名查询用户</span></span><br><span class="line">    Map&lt;String, Object&gt; map = ThreadLocalUtil.get();</span><br><span class="line">    <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> (String) map.get(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userService.findByUsername(username);</span><br><span class="line">    <span class="keyword">return</span> Result.success(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="更新用户信息">更新用户信息</h4>
<p>区别于上面的个别参数校验，有时候前端会传过来一个对象(实际上是json字符串)，就不能在形参上对每个成员变量做校验了，因此我们可以在实体类的成员变量上添加注释，比如<code>@NotNull</code>不能为空、<code>@NotEmpty</code>不能为空的同时字符串不能为空、<code>@Email</code>检验邮箱字符串的合法性</p>
<ol type="1">
<li>在用户实体类上添加注解 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    <span class="keyword">private</span> Integer id;<span class="comment">//主键ID</span></span><br><span class="line">    <span class="keyword">private</span> String username;<span class="comment">//用户名</span></span><br><span class="line">    <span class="meta">@JsonIgnore</span> <span class="comment">//把当前对象转为json字符串时忽略密码</span></span><br><span class="line">    <span class="keyword">private</span> String password;<span class="comment">//密码</span></span><br><span class="line">    <span class="meta">@NotEmpty</span></span><br><span class="line">    <span class="meta">@Pattern(regexp = &quot;^\\S&#123;1,10&#125;$&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String nickname;<span class="comment">//昵称</span></span><br><span class="line">    <span class="meta">@NotEmpty</span></span><br><span class="line">    <span class="meta">@Email</span></span><br><span class="line">    <span class="keyword">private</span> String email;<span class="comment">//邮箱</span></span><br><span class="line">    <span class="keyword">private</span> String userPic;<span class="comment">//用户头像地址</span></span><br><span class="line">    <span class="keyword">private</span> LocalDateTime createTime;<span class="comment">//创建时间</span></span><br><span class="line">    <span class="keyword">private</span> LocalDateTime updateTime;<span class="comment">//更新时间</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>在<code>UserController</code>实现更新用户信息的方法，并且在形参上添加<code>@Validated</code>注解
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PutMapping(&quot;/update&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">update</span><span class="params">(<span class="meta">@RequestBody</span> <span class="meta">@Validated</span> User user)</span>&#123;</span><br><span class="line">    userService.update(user);</span><br><span class="line">    <span class="keyword">return</span> Result.success();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>在<code>UserServiceImpl</code>中实现接口方法 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(User user)</span> &#123;</span><br><span class="line">    user.setUpdateTime(LocalDateTime.now());</span><br><span class="line">    userMapper.update(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>在<code>UserMapper</code>中实现操作数据库的方法 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//更新用户</span></span><br><span class="line"><span class="meta">@Update(&quot;update user set nickname = #&#123;nickname&#125;, email = #&#123;email&#125;, update_time = #&#123;updateTime&#125; where id = #&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">update</span><span class="params">(User user)</span>;</span><br></pre></td></tr></table></figure></li>
</ol>
<h5 id="更新用户头像">更新用户头像</h5>
<ol type="1">
<li>在<code>UserController</code>中实现方法 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PatchMapping(&quot;/updateAvatar&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">updateAvatar</span><span class="params">(<span class="meta">@RequestParam</span> <span class="meta">@URL</span> String avatarUrl)</span>&#123;</span><br><span class="line">    userService.updateAvatar(avatarUrl);</span><br><span class="line">    <span class="keyword">return</span> Result.success();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
其中使用validation的<code>@URL</code>校验传递过来的参数是否是URL</li>
<li>在<code>UserServiceImpl</code>中实现接口 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateAvatar</span><span class="params">(String avatarUrl)</span> &#123;</span><br><span class="line">    Map&lt;String, Object&gt; map = ThreadLocalUtil.get();</span><br><span class="line">    <span class="type">Integer</span> <span class="variable">id</span> <span class="operator">=</span> (Integer) map.get(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">    userMapper.updateAvatar(avatarUrl, id);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
其中，通过ThreadLocal获取用户id</li>
<li>在<code>UserMapper</code>中对数据库进行操作 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//更新头像</span></span><br><span class="line"><span class="meta">@Update(&quot;update user set user_pic = #&#123;avatarUrl&#125;, update_time = now() where id = #&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">updateAvatar</span><span class="params">(String avatarUrl, Integer id)</span>;</span><br></pre></td></tr></table></figure></li>
</ol>
<h5 id="更新用户密码">更新用户密码</h5>
<ol type="1">
<li><p>在<code>UserController</code>中实现方法 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PatchMapping(&quot;/updatePwd&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">updatePwd</span><span class="params">(<span class="meta">@RequestBody</span> Map&lt;String, String&gt; params)</span>&#123;</span><br><span class="line">    <span class="comment">//参数校验</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">old_pwd</span> <span class="operator">=</span> params.get(<span class="string">&quot;old_pwd&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">new_pwd</span> <span class="operator">=</span> params.get(<span class="string">&quot;new_pwd&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">re_pwd</span> <span class="operator">=</span> params.get(<span class="string">&quot;re_pwd&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(!StringUtils.hasLength(old_pwd) || !StringUtils.hasLength(new_pwd) || !StringUtils.hasLength(re_pwd))&#123;</span><br><span class="line">        <span class="keyword">return</span> Result.error(<span class="string">&quot;缺少必要的参数&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//根据用户名获取密码</span></span><br><span class="line">    Map&lt;String, Object&gt; map = ThreadLocalUtil.get();</span><br><span class="line">    <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> (String) map.get(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userService.findByUsername(username);</span><br><span class="line">    <span class="comment">//和old_pwd进行比对</span></span><br><span class="line">    <span class="keyword">if</span>(!user.getPassword().equals(Md5Util.getMD5String(old_pwd)))&#123;</span><br><span class="line">        <span class="keyword">return</span> Result.error(<span class="string">&quot;原密码填写不正确&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//new_pwd和re_pwd是否一样</span></span><br><span class="line">    <span class="keyword">if</span>(!new_pwd.equals(re_pwd))&#123;</span><br><span class="line">        <span class="keyword">return</span> Result.error(<span class="string">&quot;两次填写的新密码不一样&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//调用Service完成密码更新</span></span><br><span class="line">    userService.updatePwd(new_pwd);</span><br><span class="line">    <span class="keyword">return</span> Result.success();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></li>
<li><p>在<code>UserServiceImpl</code>中实现接口 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updatePwd</span><span class="params">(String new_pwd)</span> &#123;</span><br><span class="line">    Map&lt;String, Object&gt; map = ThreadLocalUtil.get();</span><br><span class="line">    <span class="type">Integer</span> <span class="variable">id</span> <span class="operator">=</span> (Integer) map.get(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">    userMapper.updatePwd(Md5Util.getMD5String(new_pwd), id);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></li>
<li><p>在<code>UserMapper</code>中对数据库进行操作
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//更新密码</span></span><br><span class="line"><span class="meta">@Update(&quot;update user set password = #&#123;md5String&#125;, update_time = now() where id = #&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">updatePwd</span><span class="params">(String md5String, Integer id)</span>;</span><br></pre></td></tr></table></figure></p></li>
</ol>
<h3 id="分类相关接口">分类相关接口</h3>
<h4 id="新增分类">新增分类</h4>
<ol type="1">
<li><p>导入分类实体类，其中名称和分类是用户需要填写的，应设校验
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Category</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;<span class="comment">//主键ID</span></span><br><span class="line">    <span class="meta">@NotEmpty</span></span><br><span class="line">    <span class="keyword">private</span> String categoryName;<span class="comment">//分类名称</span></span><br><span class="line">    <span class="meta">@NotEmpty</span></span><br><span class="line">    <span class="keyword">private</span> String categoryAlias;<span class="comment">//分类别名</span></span><br><span class="line">    <span class="keyword">private</span> Integer createUser;<span class="comment">//创建人ID</span></span><br><span class="line">    <span class="keyword">private</span> LocalDateTime createTime;<span class="comment">//创建时间</span></span><br><span class="line">    <span class="keyword">private</span> LocalDateTime updateTime;<span class="comment">//更新时间</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></li>
<li><p>在<code>CategoryController</code>中实现方法
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/category&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CategoryController</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> CategoryService categoryService;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@PostMapping</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">addCategory</span><span class="params">(<span class="meta">@RequestBody</span> <span class="meta">@Validated</span> Category category)</span>&#123;</span><br><span class="line">        categoryService.addCategory(category);</span><br><span class="line">        <span class="keyword">return</span> Result.success();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></li>
<li><p>在<code>CategoryServiceImpl</code>中实现接口
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//新增分类</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addCategory</span><span class="params">(Category category)</span> &#123;</span><br><span class="line">    <span class="comment">//补充属性</span></span><br><span class="line">    Map&lt;String, Object&gt; map = ThreadLocalUtil.get();</span><br><span class="line">    <span class="type">Integer</span> <span class="variable">id</span> <span class="operator">=</span> (Integer) map.get(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">    category.setCreateTime(LocalDateTime.now());</span><br><span class="line">    category.setUpdateTime(LocalDateTime.now());</span><br><span class="line">    category.setCreateUser(id);</span><br><span class="line">    </span><br><span class="line">    categoryMapper.addCategory(category);</span><br></pre></td></tr></table></figure></p></li>
<li><p>在<code>CategoryMapper</code>中操作数据库 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//新增分类</span></span><br><span class="line"><span class="meta">@Insert(&quot;insert into category(category_name, category_alias, create_user, create_time, update_time)&quot; +</span></span><br><span class="line"><span class="meta">        &quot;values(#&#123;categoryName&#125;, #&#123;categoryAlias&#125;, #&#123;createUser&#125;, #&#123;createTime&#125;, #&#123;updateTime&#125;)&quot;)</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">addCategory</span><span class="params">(Category category)</span>;</span><br></pre></td></tr></table></figure></p></li>
</ol>
<h4 id="查询分类">查询分类</h4>
<ol type="1">
<li><p>在<code>CategoryController</code>中实现方法
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping</span></span><br><span class="line"><span class="keyword">public</span> Result&lt;List&lt;Category&gt;&gt; <span class="title function_">list</span><span class="params">()</span>&#123;</span><br><span class="line">    List&lt;Category&gt; categoryList = categoryService.list();</span><br><span class="line">    <span class="keyword">return</span> Result.success(categoryList);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></li>
<li><p>在<code>CategoryServiceImpl</code>中实现接口
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//查询分类列表</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> List&lt;Category&gt; <span class="title function_">list</span><span class="params">()</span> &#123;</span><br><span class="line">    Map&lt;String, Object&gt; map = ThreadLocalUtil.get();</span><br><span class="line">    <span class="type">Integer</span> <span class="variable">id</span> <span class="operator">=</span> (Integer) map.get(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    List&lt;Category&gt; categoryList = categoryMapper.list(id);</span><br><span class="line">    <span class="keyword">return</span> categoryList;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></li>
<li><p>在<code>CategoryMapper</code>中操作数据库 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//查询分类列表</span></span><br><span class="line"><span class="meta">@Select(&quot;select * from category where create_user = #&#123;id&#125;&quot;)</span></span><br><span class="line">List&lt;Category&gt; <span class="title function_">list</span><span class="params">(Integer id)</span>;</span><br></pre></td></tr></table></figure></p></li>
<li><p>在分类实体类的创建时间和更新时间上添加注解，以展示正确的时间格式
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@JsonFormat(pattern = &quot;yyyy-MM-dd HH:mm:ss&quot;)</span></span><br><span class="line"><span class="keyword">private</span> LocalDateTime createTime;<span class="comment">//创建时间</span></span><br><span class="line"><span class="meta">@JsonFormat(pattern = &quot;yyyy-MM-dd HH:mm:ss&quot;)</span></span><br><span class="line"><span class="keyword">private</span> LocalDateTime updateTime;<span class="comment">//更新时间</span></span><br></pre></td></tr></table></figure></p></li>
</ol>
<h4 id="查询分类详情">查询分类详情</h4>
<p>查询分类详情用于用户在点击编辑按钮的时候可以回显数据 1.
在<code>CategoryController</code>中实现方法 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/detail&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result&lt;Category&gt; <span class="title function_">detail</span><span class="params">(Integer id)</span>&#123;</span><br><span class="line">    <span class="type">Category</span> <span class="variable">category</span> <span class="operator">=</span> categoryService.findById(id);</span><br><span class="line">    <span class="keyword">return</span> Result.success(category);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure> 2.
在<code>CategoryServiceImpl</code>中实现接口 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//根据id查询分类详情</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Category <span class="title function_">findById</span><span class="params">(Integer id)</span> &#123;</span><br><span class="line">    <span class="type">Category</span> <span class="variable">category</span> <span class="operator">=</span> categoryMapper.findById(id);</span><br><span class="line">    <span class="keyword">return</span> category;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure> 3.
在<code>CategoryMapper</code>中操作数据库 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//根据id查询分类详情</span></span><br><span class="line"><span class="meta">@Select(&quot;select * from category where id = #&#123;id&#125;&quot;)</span></span><br><span class="line">Category <span class="title function_">findById</span><span class="params">(Integer id)</span>;</span><br></pre></td></tr></table></figure></p>
<h4 id="删除分类">删除分类</h4>
<ol type="1">
<li>在<code>CategoryController</code>中实现方法 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@DeleteMapping</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">deleteById</span><span class="params">(Integer id)</span>&#123;</span><br><span class="line">    categoryService.deleteById(id);</span><br><span class="line">    <span class="keyword">return</span> Result.success();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>在<code>CategoryServiceImpl</code>中实现接口 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//根据id删除分类</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteById</span><span class="params">(Integer id)</span> &#123;</span><br><span class="line">    categoryMapper.deleteById(id);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>在<code>CategoryMapper</code>中操作数据库 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//根据id删除分类</span></span><br><span class="line"><span class="meta">@Delete(&quot;delete from category where id = #&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">deleteById</span><span class="params">(Integer id)</span>;</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="更新分类">更新分类</h4>
<ol type="1">
<li>在<code>CategoryController</code>中实现方法 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PutMapping</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">update</span><span class="params">(<span class="meta">@RequestBody</span> <span class="meta">@Validated</span> Category category)</span>&#123;</span><br><span class="line">    categoryService.update(category);</span><br><span class="line">    <span class="keyword">return</span> Result.success();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>在<code>CategoryServiceImpl</code>中实现接口 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Category category)</span> &#123;</span><br><span class="line">    category.setUpdateTime(LocalDateTime.now());</span><br><span class="line">    categoryMapper.update(category);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>在<code>CategoryMapper</code>中操作数据库 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//更新分类</span></span><br><span class="line"><span class="meta">@Update(&quot;update category set category_name = #&#123;categoryName&#125;, category_alias = #&#123;categoryAlias&#125;, update_time = #&#123;updateTime&#125; &quot; +</span></span><br><span class="line"><span class="meta">        &quot;where id = #&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Category category)</span>;</span><br></pre></td></tr></table></figure></li>
<li>在分类实体类中为 id 添加非空校验 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@NotNull</span></span><br><span class="line"><span class="keyword">private</span> Integer id;<span class="comment">//主键ID</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h5 id="分组校验">分组校验</h5>
<p>当给 id 添加非空校验后，如果提交添加分类请求就会报错，因为没有携带 id
参数。为了解决这个问题，我们需要给校验做分组，即不同参数使用不同的校验
1. 在实体类中定义分组 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Add</span>&#123;&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Update</span>&#123;&#125;</span><br></pre></td></tr></table></figure> 2. 定义校验项时指定归属的分组
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@NotNull(groups = Update.class)</span></span><br><span class="line"><span class="keyword">private</span> Integer id;<span class="comment">//主键ID</span></span><br><span class="line"><span class="meta">@NotEmpty(groups = &#123;Update.class, Add.class&#125;)</span></span><br><span class="line"><span class="keyword">private</span> String categoryName;<span class="comment">//分类名称</span></span><br><span class="line"><span class="meta">@NotEmpty(groups = &#123;Update.class, Add.class&#125;)</span></span><br><span class="line"><span class="keyword">private</span> String categoryAlias;<span class="comment">//分类别名</span></span><br></pre></td></tr></table></figure> 3. 校验时指定要校验的分组 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Result <span class="title function_">addCategory</span><span class="params">(<span class="meta">@RequestBody</span> <span class="meta">@Validated(Category.Add.class)</span> Category category)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">update</span><span class="params">(<span class="meta">@RequestBody</span> <span class="meta">@Validated(Category.Update.class)</span> Category category)</span></span><br></pre></td></tr></table></figure></p>
<p>但是如果碰到分组较多的情况时，我们也有办法简化代码。如果某个校验项没有指定分组，默认属于<code>Default</code>分组；分组之间也可以继承，比如<code>A extends B</code>，表示A中拥有B的所有校验项</p>
<ol type="1">
<li>在实体类中定义分组 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Add</span> <span class="keyword">extends</span> <span class="title class_">Default</span> &#123;&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Update</span> <span class="keyword">extends</span> <span class="title class_">Default</span> &#123;&#125;</span><br></pre></td></tr></table></figure></li>
<li>定义校验项时指定归属的分组 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@NotNull(groups = Update.class)</span></span><br><span class="line"><span class="keyword">private</span> Integer id;<span class="comment">//主键ID</span></span><br><span class="line"><span class="meta">@NotEmpty</span></span><br><span class="line"><span class="keyword">private</span> String categoryName;<span class="comment">//分类名称</span></span><br><span class="line"><span class="meta">@NotEmpty</span></span><br><span class="line"><span class="keyword">private</span> String categoryAlias;<span class="comment">//分类别名</span></span><br></pre></td></tr></table></figure></li>
<li>校验时指定要校验的分组</li>
</ol>
<h3 id="文章相关接口">文章相关接口</h3>
<h4 id="新增文章">新增文章</h4>
<ol type="1">
<li>在<code>ArticleController</code>中实现方法 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">add</span><span class="params">(<span class="meta">@RequestBody</span> <span class="meta">@Validated</span> Article article)</span>&#123;</span><br><span class="line">    articleService.add(article);</span><br><span class="line">    <span class="keyword">return</span> Result.success();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>在<code>ArticleServiceImpl</code>中实现接口 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//新增文章</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(Article article)</span> &#123;</span><br><span class="line">    <span class="comment">//补充属性</span></span><br><span class="line">    Map&lt;String, Object&gt; map = ThreadLocalUtil.get();</span><br><span class="line">    <span class="type">Integer</span> <span class="variable">id</span> <span class="operator">=</span> (Integer) map.get(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">    article.setCreateTime(LocalDateTime.now());</span><br><span class="line">    article.setUpdateTime(LocalDateTime.now());</span><br><span class="line">    article.setCreateUser(id);</span><br><span class="line">    </span><br><span class="line">    articleMapper.add(article);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>在<code>ArticleMapper</code>中操作数据库 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//新增文章</span></span><br><span class="line"><span class="meta">@Insert(&quot;insert into article(title, content, cover_img, state, category_id, create_user, create_time, update_time) &quot; +</span></span><br><span class="line"><span class="meta">        &quot;values(#&#123;title&#125;, #&#123;content&#125;, #&#123;coverImg&#125;, #&#123;state&#125;, #&#123;categoryId&#125;, #&#123;createUser&#125;, #&#123;createTime&#125;, #&#123;updateTime&#125;)&quot;)</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">add</span><span class="params">(Article article)</span>;</span><br></pre></td></tr></table></figure></li>
<li>在文章实体类中添加注解校验 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Integer id;<span class="comment">//主键ID</span></span><br><span class="line"><span class="meta">@NotEmpty</span></span><br><span class="line"><span class="meta">@Pattern(regexp = &quot;^\\S&#123;1,10&#125;$&quot;)</span></span><br><span class="line"><span class="keyword">private</span> String title;<span class="comment">//文章标题</span></span><br><span class="line"><span class="meta">@NotEmpty</span></span><br><span class="line"><span class="keyword">private</span> String content;<span class="comment">//文章内容</span></span><br><span class="line"><span class="meta">@NotEmpty</span></span><br><span class="line"><span class="meta">@URL</span></span><br><span class="line"><span class="keyword">private</span> String coverImg;<span class="comment">//封面图像</span></span><br><span class="line"><span class="keyword">private</span> String state;<span class="comment">//发布状态 已发布|草稿</span></span><br><span class="line"><span class="meta">@NotNull</span></span><br><span class="line"><span class="keyword">private</span> Integer categoryId;<span class="comment">//文章分类id</span></span><br><span class="line"><span class="keyword">private</span> Integer createUser;<span class="comment">//创建人ID</span></span><br><span class="line"><span class="keyword">private</span> LocalDateTime createTime;<span class="comment">//创建时间</span></span><br><span class="line"><span class="keyword">private</span> LocalDateTime updateTime;<span class="comment">//更新时间</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h5 id="自定义注解">自定义注解</h5>
<p>我们需要为<code>state</code>也赋予校验，但是没有现成的注解能够提供校验，因此我们需要自定义校验
1. 创建 anno 文件夹，自定义注解<code>State</code> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Documented</span> <span class="comment">//元注解</span></span><br><span class="line"><span class="meta">@Target(&#123;ElementType.FIELD&#125;)</span> <span class="comment">//指定该注解在哪里可以使用</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span> <span class="comment">//指定该注解在何时使用</span></span><br><span class="line"><span class="meta">@Constraint(</span></span><br><span class="line"><span class="meta">        validatedBy = &#123; StateValidation.class &#125;</span></span><br><span class="line"><span class="meta">)</span> <span class="comment">//提供校验规则的类</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> State &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//提供校验失败后的展示信息</span></span><br><span class="line">    String <span class="title function_">message</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;state参数的值只能是“已发布或”或“草稿”&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//指定分组</span></span><br><span class="line">    Class&lt;?&gt;[] groups() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//负载：获取State注解的附加信息</span></span><br><span class="line">    Class&lt;? <span class="keyword">extends</span> <span class="title class_">Payload</span>&gt;[] payload() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
注意：必须包括三个变量：<code>message</code>、<code>groups</code>、<code>payload</code></p>
<ol start="2" type="1">
<li><p>创建 validation
文件夹，自定义校验数据的类<code>StateValidation</code>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StateValidation</span> <span class="keyword">implements</span> <span class="title class_">ConstraintValidator</span>&lt;State, String&gt;  &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> s 要校验的数据</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> constraintValidatorContext</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 返回true表示校验通过，返回false表示校验不通过</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isValid</span><span class="params">(String s, ConstraintValidatorContext constraintValidatorContext)</span> &#123;</span><br><span class="line">        <span class="comment">//提供校验规则</span></span><br><span class="line">        <span class="keyword">if</span>(s == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(s.equals(<span class="string">&quot;已发布&quot;</span>) || s.equals(<span class="string">&quot;草稿&quot;</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></li>
<li><p>在需要校验的地方使用自定义注解 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@State</span></span><br><span class="line"><span class="keyword">private</span> String state;<span class="comment">//发布状态 已发布|草稿</span></span><br></pre></td></tr></table></figure></p></li>
</ol>
<h4 id="文章分页查询">文章分页查询</h4>
<ol type="1">
<li><p>编写<code>PageBean</code>实体类，将总条数和当前页每条数据的详情封装在一起
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//分页返回结果对象</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PageBean</span> &lt;T&gt;&#123;</span><br><span class="line">    <span class="keyword">private</span> Long total;<span class="comment">//总条数</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;T&gt; items;<span class="comment">//当前页数据集合</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></li>
<li><p>在<code>ArticleController</code>中实现方法，其中<code>categoryId</code>文章分类和<code>state</code>文章状态是搜索下拉框选定的，属于可选参数，因此需要<code>@RequestParam(required = false)</code>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping</span></span><br><span class="line"><span class="keyword">public</span> Result&lt;PageBean&lt;Article&gt;&gt; <span class="title function_">list</span><span class="params">(Integer pageNum,</span></span><br><span class="line"><span class="params">                                      Integer pageSize,</span></span><br><span class="line"><span class="params">                                      <span class="meta">@RequestParam(required = false)</span> Integer categoryId,</span></span><br><span class="line"><span class="params">                                      <span class="meta">@RequestParam(required = false)</span> String state)</span> &#123;</span><br><span class="line">    PageBean&lt;Article&gt; pb = articleService.list(pageNum, pageSize, categoryId, state);</span><br><span class="line">    <span class="keyword">return</span> Result.success(pb);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></li>
<li><p>导入<code>PageHelper</code>坐标 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- pageHelper坐标 --&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">	&lt;groupId&gt;com.github.pagehelper&lt;/groupId&gt;</span><br><span class="line">	&lt;artifactId&gt;pagehelper-spring-boot-starter&lt;/artifactId&gt;</span><br><span class="line">	&lt;version&gt;<span class="number">1.4</span><span class="number">.6</span>&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure></p></li>
<li><p>在<code>ArticleServiceImpl</code>中实现接口 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//文章分页查询</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> PageBean&lt;Article&gt; <span class="title function_">list</span><span class="params">(Integer pageNum, Integer pageSize, Integer categoryId, String state)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//创建PageBean对象</span></span><br><span class="line">    PageBean&lt;Article&gt; pb = <span class="keyword">new</span> <span class="title class_">PageBean</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//开启分页查询 PageHelper</span></span><br><span class="line">    PageHelper.startPage(pageNum, pageSize);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//调用Mapper</span></span><br><span class="line">    Map&lt;String, Object&gt; map = ThreadLocalUtil.get();</span><br><span class="line">    <span class="type">Integer</span> <span class="variable">id</span> <span class="operator">=</span> (Integer) map.get(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">    List&lt;Article&gt; articleList = articleMapper.list(id, categoryId, state);</span><br><span class="line"></span><br><span class="line">    Page&lt;Article&gt; p = (Page&lt;Article&gt;) articleList;</span><br><span class="line">    pb.setTotal(p.getTotal());</span><br><span class="line">    pb.setItems(p.getResult());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> pb;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
使用<code>PageHelper.startPage()</code>通过设置当前页和每页数据条数开启分页查询，然后查找文章列表，将文章列表强转为<code>Page</code>对象，其中包含每页的数据，还有总页数等元数据，最后将<code>Page</code>对象的两个属性赋值给<code>pb</code>返回</p></li>
<li><p>在<code>ArticleMapper</code>中操作数据库 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//文章分页查询</span></span><br><span class="line">List&lt;Article&gt; <span class="title function_">list</span><span class="params">(Integer id, Integer categoryId, String state)</span>;</span><br></pre></td></tr></table></figure>
由于是动态SQL语句，使用注解的方式编写SQL语句不太方便，因此需要 MyBatis
映射文件</p></li>
<li><p>在 resources
文件夹下，创建<code>com/sues/bigevent/mapper</code>目录，注意是<code>/</code>，创建
ArticleMapper.xml，路径和文件名保持一致 <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure> 编写动态SQL语句
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 指定需要映射的路径 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.sues.bigevent.mapper.ArticleMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 指定需要映射的方法名和返回值类型 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;list&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.sues.bigevent.pojo.Article&quot;</span>&gt;</span></span><br><span class="line">        select * from article</span><br><span class="line">        <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;categoryId != null&quot;</span>&gt;</span></span><br><span class="line">                category_id = #&#123;categoryId&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;state != null&quot;</span>&gt;</span></span><br><span class="line">                and state = #&#123;state&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            and create_user = #&#123;id&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure></p></li>
</ol>
<h4 id="获取文章详情">获取文章详情</h4>
<ol type="1">
<li>在<code>ArticleController</code>中实现方法 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/detail&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result&lt;Article&gt; <span class="title function_">findById</span><span class="params">(Integer id)</span>&#123;</span><br><span class="line">    <span class="type">Article</span> <span class="variable">article</span> <span class="operator">=</span> articleService.findById(id);</span><br><span class="line">    <span class="keyword">return</span> Result.success(article);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>在<code>ArticleServiceImpl</code>中实现接口 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Article <span class="title function_">findById</span><span class="params">(Integer id)</span> &#123;</span><br><span class="line">    <span class="type">Article</span> <span class="variable">article</span> <span class="operator">=</span> articleMapper.findById(id);</span><br><span class="line">    <span class="keyword">return</span> article;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>在<code>ArticleMapper</code>中操作数据库 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取文章详情</span></span><br><span class="line"><span class="meta">@Select(&quot;select * from article where id = #&#123;id&#125;&quot;)</span></span><br><span class="line">Article <span class="title function_">findById</span><span class="params">(Integer id)</span>;</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="更新文章">更新文章</h4>
<ol type="1">
<li>在<code>ArticleController</code>中实现方法 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PutMapping</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">update</span><span class="params">(<span class="meta">@RequestBody</span> <span class="meta">@Validated(Article.Update.class)</span> Article article)</span>&#123;</span><br><span class="line">    articleService.update(article);</span><br><span class="line">    <span class="keyword">return</span> Result.success();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>在<code>ArticleServiceImpl</code>中实现接口 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Article article)</span> &#123;</span><br><span class="line">    article.setUpdateTime(LocalDateTime.now());</span><br><span class="line">    articleMapper.update(article);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>在<code>ArticleMapper</code>中操作数据库 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//更新文章</span></span><br><span class="line"><span class="meta">@Update(&quot;update article set title = #&#123;title&#125;, content = #&#123;content&#125;, cover_img = #&#123;coverImg&#125;, &quot; +</span></span><br><span class="line"><span class="meta">        &quot;state = #&#123;state&#125;, category_id = #&#123;categoryId&#125;, update_time = #&#123;updateTime&#125; &quot; +</span></span><br><span class="line"><span class="meta">        &quot;where id = #&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Article article)</span>;</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="删除文章">删除文章</h4>
<ol type="1">
<li>在<code>ArticleController</code>中实现方法 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@DeleteMapping</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">delete</span><span class="params">(Integer id)</span>&#123;</span><br><span class="line">    articleService.delete(id);</span><br><span class="line">    <span class="keyword">return</span> Result.success();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>在<code>ArticleServiceImpl</code>中实现接口 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">(Integer id)</span> &#123;</span><br><span class="line">    articleMapper.delete(id);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>在<code>ArticleMapper</code>中操作数据库 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//删除文章</span></span><br><span class="line"><span class="meta">@Delete(&quot;delete from article where id = #&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">delete</span><span class="params">(Integer id)</span>;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="文件上传接口">文件上传接口</h3>
<h4 id="本地存储">本地存储</h4>
<ol type="1">
<li><p>首先了解上传文件的前端三要素 <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;/upload&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line">    头像：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;image&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;提交&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
前端三要素：请求方法<code>post</code>、请求参数格式<code>multipart/form-data</code>、input形式<code>file</code></p></li>
<li><p>了解<code>MultipartFile</code>的 API <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">String <span class="title function_">getOriginFilename</span><span class="params">()</span>; <span class="comment">//获取原始文件名</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">transferTo</span><span class="params">(File dest)</span>; <span class="comment">//将接收的文件转存到磁盘文件中</span></span><br><span class="line"></span><br><span class="line"><span class="type">long</span> <span class="title function_">getSize</span><span class="params">()</span>; <span class="comment">//获取文件的大小，单位：字节</span></span><br><span class="line"></span><br><span class="line"><span class="type">byte</span>[] getBytes(); <span class="comment">//获取文件内容的字节数组</span></span><br><span class="line"></span><br><span class="line">InputStream <span class="title function_">getInputStream</span><span class="params">()</span>; <span class="comment">//获取接收到的文件内容的输入流</span></span><br></pre></td></tr></table></figure></p></li>
<li><p>新建<code>FileUploadController</code>类 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FileUploadController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/upload&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;String&gt; <span class="title function_">upload</span><span class="params">(MultipartFile file)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">//将文件的内容存储到本地磁盘中</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">originalFilename</span> <span class="operator">=</span> file.getOriginalFilename();</span><br><span class="line">        <span class="comment">//保证文件名是唯一的，防止文件覆盖：使用UUID + 原后缀名</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">filename</span> <span class="operator">=</span> UUID.randomUUID().toString() + originalFilename.substring(originalFilename.lastIndexOf(<span class="string">&quot;.&quot;</span>));</span><br><span class="line">        file.transferTo(<span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;D:\\Software\\IDEA Projects\\images\\&quot;</span> + filename));</span><br><span class="line">        <span class="keyword">return</span> Result.success(<span class="string">&quot;url访问地址&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></li>
</ol>
<h4 id="阿里云oss存储文件">阿里云OSS存储文件</h4>
<ol type="1">
<li><p>添加阿里云OSS依赖坐标 &gt;
参考文档：https://help.aliyun.com/zh/oss/developer-reference/java-installation
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 阿里云OSS依赖坐标 START --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.aliyun.oss<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>aliyun-sdk-oss<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>3.15.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.xml.bind<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jaxb-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.activation<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>activation<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- no more than 2.3.3--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.glassfish.jaxb<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jaxb-runtime<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 阿里云OSS依赖坐标 END --&gt;</span></span><br></pre></td></tr></table></figure></p></li>
<li><p>编写代码实现文件上传 &gt;
参考文档：https://help.aliyun.com/zh/oss/developer-reference/simple-upload-11</p></li>
</ol>
<p>我们将SDK修改并封装为自己的工具类进行使用，新建<code>AliOssUtil</code>，获取阿里云账户的访问凭证
Access_Key 和 Access_Secret，然后创建 Bucket，获取区域节点和 Bucket 名称
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AliOssUtil</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Endpoint：华东2（上海）</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">ENDPOINT</span> <span class="operator">=</span> <span class="string">&quot;XXX&quot;</span>;</span><br><span class="line">    <span class="comment">// 访问凭证：ACCESS_KEY_ID和ACCESS_KEY_SECRET</span></span><br><span class="line">    <span class="comment">//EnvironmentVariableCredentialsProvider credentialsProvider = CredentialsProviderFactory.newEnvironmentVariableCredentialsProvider();</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">ACCESS_KEY_ID</span> <span class="operator">=</span> <span class="string">&quot;XXX&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">ACCESS_KEY_SECRET</span> <span class="operator">=</span> <span class="string">&quot;XXX&quot;</span>;</span><br><span class="line">    <span class="comment">// Bucket名称</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">BUCKET_NAME</span> <span class="operator">=</span> <span class="string">&quot;XXX&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">uploadFile</span><span class="params">(String objName, InputStream inputStream)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 创建OSSClient实例。</span></span><br><span class="line">        <span class="type">OSS</span> <span class="variable">ossClient</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OSSClientBuilder</span>().build(ENDPOINT, ACCESS_KEY_ID, ACCESS_KEY_SECRET);</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 填写字符串。</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">content</span> <span class="operator">=</span> <span class="string">&quot;Hello OSS，你好世界&quot;</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 创建PutObjectRequest对象。</span></span><br><span class="line">            <span class="type">PutObjectRequest</span> <span class="variable">putObjectRequest</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PutObjectRequest</span>(BUCKET_NAME, objName, inputStream);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 如果需要上传时设置存储类型和访问权限，请参考以下示例代码。</span></span><br><span class="line">            <span class="comment">// ObjectMetadata metadata = new ObjectMetadata();</span></span><br><span class="line">            <span class="comment">// metadata.setHeader(OSSHeaders.OSS_STORAGE_CLASS, StorageClass.Standard.toString());</span></span><br><span class="line">            <span class="comment">// metadata.setObjectAcl(CannedAccessControlList.Private);</span></span><br><span class="line">            <span class="comment">// putObjectRequest.setMetadata(metadata);</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 上传字符串。</span></span><br><span class="line">            <span class="type">PutObjectResult</span> <span class="variable">result</span> <span class="operator">=</span> ossClient.putObject(putObjectRequest);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//url组成：https://bucket名称.区域节点/文件名</span></span><br><span class="line">            url = <span class="string">&quot;https://&quot;</span> + BUCKET_NAME + <span class="string">&quot;.&quot;</span> + ENDPOINT.substring(ENDPOINT.lastIndexOf(<span class="string">&quot;/&quot;</span>) + <span class="number">1</span>) + <span class="string">&quot;/&quot;</span> + objName;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (OSSException oe) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Caught an OSSException, which means your request made it to OSS, &quot;</span></span><br><span class="line">                    + <span class="string">&quot;but was rejected with an error response for some reason.&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;Error Message:&quot;</span> + oe.getErrorMessage());</span><br><span class="line">            System.out.println(<span class="string">&quot;Error Code:&quot;</span> + oe.getErrorCode());</span><br><span class="line">            System.out.println(<span class="string">&quot;Request ID:&quot;</span> + oe.getRequestId());</span><br><span class="line">            System.out.println(<span class="string">&quot;Host ID:&quot;</span> + oe.getHostId());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClientException ce) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Caught an ClientException, which means the client encountered &quot;</span></span><br><span class="line">                    + <span class="string">&quot;a serious internal problem while trying to communicate with OSS, &quot;</span></span><br><span class="line">                    + <span class="string">&quot;such as not being able to access the network.&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;Error Message:&quot;</span> + ce.getMessage());</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (ossClient != <span class="literal">null</span>) &#123;</span><br><span class="line">                ossClient.shutdown();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> url;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<ol start="3" type="1">
<li>修改<code>FileUploadController</code> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FileUploadController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/upload&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;String&gt; <span class="title function_">upload</span><span class="params">(MultipartFile file)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">//将文件的内容存储到本地磁盘中</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">originalFilename</span> <span class="operator">=</span> file.getOriginalFilename();</span><br><span class="line">        <span class="comment">//保证文件名是唯一的，防止文件覆盖：使用UUID + 原后缀名</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">filename</span> <span class="operator">=</span> UUID.randomUUID().toString() + originalFilename.substring(originalFilename.lastIndexOf(<span class="string">&quot;.&quot;</span>));</span><br><span class="line">        <span class="comment">//file.transferTo(new File(&quot;D:\\Software\\IDEA Projects\\images\\&quot; + filename));</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> AliOssUtil.uploadFile(filename, file.getInputStream());</span><br><span class="line">        <span class="keyword">return</span> Result.success(url);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="登录优化">登录优化</h3>
<p>我们需要解决登录成功后获取到的令牌，即使重新登陆后或者修改密码后获取到了新的令牌，旧令牌依旧可用的问题。解决思路是：
1. 登录成功后，给浏览器响应令牌的同时，把该令牌存储到redis中 2.
<code>LoginInterceptor</code>拦截器中，需要验证浏览器携带的令牌，并同时需要获取到redis中存储的与之相同的令牌</p>
<h4 id="代码实现">代码实现</h4>
<ol type="1">
<li>导入redis坐标依赖 <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- redis坐标 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>在<code>UserController</code>中注入<code>StringRedisTemplate</code>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> StringRedisTemplate stringRedisTemplate;</span><br></pre></td></tr></table></figure></li>
<li>在<code>login</code>方法中，判断密码是正确的后将生成的token存储到redis中
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//把token存储到redis中</span></span><br><span class="line">ValueOperations&lt;String, String&gt; ops = stringRedisTemplate.opsForValue();</span><br><span class="line"><span class="comment">//token字符串既做键也做值，并且设置过期时间为1小时，和token过期时间保持一致</span></span><br><span class="line">ops.set(token, token, <span class="number">1</span>, TimeUnit.HOURS);</span><br></pre></td></tr></table></figure></li>
<li>在<code>updatePwd</code>方法中添加形参<code>@RequestHeader("Authorization") String token</code>用于获取token，在密码修改完成后删除对应的token
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//删除redis中对应的token</span></span><br><span class="line">ValueOperations&lt;String, String&gt; ops = stringRedisTemplate.opsForValue();</span><br><span class="line">ops.getOperations().delete(token);</span><br></pre></td></tr></table></figure></li>
<li>在<code>LoginIntercetor</code>中查询token是否失效，如果失效抛出异常
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> StringRedisTemplate stringRedisTemplate;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="comment">//令牌验证</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> request.getHeader(<span class="string">&quot;Authorization&quot;</span>);</span><br><span class="line">    <span class="comment">//验证token</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//在redis中获取相同的token</span></span><br><span class="line">        ValueOperations&lt;String, String&gt; ops = stringRedisTemplate.opsForValue();</span><br><span class="line">        <span class="type">String</span> <span class="variable">redisToken</span> <span class="operator">=</span> ops.get(token);</span><br><span class="line">        <span class="keyword">if</span>(redisToken == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="comment">//token失效</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="项目部署">项目部署</h3>
<h4 id="项目打包">项目打包</h4>
<ol type="1">
<li>添加 maven 打包插件，注意是插件，不是依赖 <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 打包插件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>运行 maven 的 package 命令</li>
</ol>
<h4 id="属性配置">属性配置</h4>
<ol type="1">
<li><p>命令行参数方式
在命令后面直接跟上<code>--</code>加配置项的形式，比如：
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar XXX.jar --server.port=8081</span><br></pre></td></tr></table></figure></p></li>
<li><p>环境变量方式
在用户环境变量中比如添加变量名<code>server.port</code>，添加变量值<code>8081</code>，设置换成后重启黑窗口再<code>java -jar</code>启动项目</p></li>
<li><p>外部配置文件方式
在jar包的同目录下创建另一个application.yml文件，写入需要的配置项，再<code>java -jar</code>启动项目。但是项目中resources目录下的配置文件优先级更高</p></li>
</ol>
<h4 id="多环境开发">多环境开发</h4>
<p>多环境开发有单文件和多文件的配置方式，单文件在 SpringBoot
笔记中有介绍，就是将<code>---</code>将不同环境的配置项分隔开。但是单文件配置方式可能会因为写在一起导致不方便维护，因此可以采用多文件配置方式。在
resources 目录下新建 application-环境名称.yml ，例如 application-dev.yml
和 application-test.yml ，然后在 application.yml
中填写共性的配置项以及需要激活的环境 <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#指定激活的环境，比如test</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">    <span class="attr">profiles:</span></span><br><span class="line">        <span class="attr">active:</span> <span class="string">test</span></span><br></pre></td></tr></table></figure></p>
<h2 id="复习一下前端">复习一下前端</h2>
<h3 id="js导入导出">js导入导出</h3>
<p>模块导入导出各种类型的变量，如字符串，数值，函数，类 -
导出的函数声明与类声明必须要有名称（export default 命令另外考虑） -
不仅能导出声明还能导出引用（例如函数） -
<code>export</code>命令可以出现在模块的任何位置，但必需处于模块顶层 -
<code>import</code>命令会提升到整个模块的头部，首先执行 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*-----export [test.js]-----*/</span></span><br><span class="line"><span class="keyword">let</span> myName = <span class="string">&quot;Tom&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> myAge = <span class="number">20</span>;</span><br><span class="line"><span class="keyword">export</span> myfn = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;My name is&quot;</span> + myName + <span class="string">&quot;! I&#x27;m &#x27;&quot;</span> + myAge + <span class="string">&quot;years old.&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> myClass =  <span class="keyword">class</span> <span class="title class_">myClass</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> a = <span class="string">&quot;yeah!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> &#123; myName, myAge &#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/*-----import [xxx.js]-----*/</span></span><br><span class="line"><span class="keyword">import</span> &#123; myName, myAge, myfn, myClass &#125; <span class="keyword">from</span> <span class="string">&quot;./test.js&quot;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">myfn</span>());<span class="comment">// My name is Tom! I&#x27;m 20 years old.</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(myAge);<span class="comment">// 20</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(myName);<span class="comment">// Tom</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(myClass.<span class="property">a</span> );<span class="comment">// yeah!</span></span><br></pre></td></tr></table></figure>
默认导出不需要声明变量名，导入的时候也不可以需要写花括号 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;&#125;</span><br></pre></td></tr></table></figure>
不同模块导出接口名称命名重复， 使用 as 重新定义变量名
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> &#123; myName <span class="keyword">as</span> exportName &#125;</span><br><span class="line"><span class="comment">//或</span></span><br><span class="line"><span class="keyword">import</span> &#123; myName <span class="keyword">as</span> name1 &#125; <span class="keyword">from</span> <span class="string">&quot;./test1.js&quot;</span>;</span><br></pre></td></tr></table></figure></p>
<h3 id="element-plus使用">element-plus使用</h3>
<ol type="1">
<li>在需要存放代码文件的文件夹中打开终端，输入命令创建项目，然后输入项目名称
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm init vue@latest</span><br></pre></td></tr></table></figure></li>
<li>进入项目文件夹，安装element-plus <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cd 项目名称</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">用VSCode打开项目</span></span><br><span class="line">code .</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">安装element-plus</span></span><br><span class="line">npm install element-plus --save</span><br></pre></td></tr></table></figure></li>
<li>参考官方文档，引入element-plus <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ElementPlus</span> <span class="keyword">from</span> <span class="string">&#x27;element-plus&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;element-plus/dist/index.css&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">createApp</span>(<span class="title class_">App</span>)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title class_">ElementPlus</span>)</span><br><span class="line">app.<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="大事件前端开发">大事件前端开发</h2>
<h3 id="前期准备">前期准备</h3>
<ol type="1">
<li>在需要存放代码文件的文件夹中打开终端，输入命令创建项目，然后输入项目名称
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm init vue@latest</span><br></pre></td></tr></table></figure></li>
<li>进入项目文件夹，安装element-plus <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd big-event</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">用VSCode打开项目</span></span><br><span class="line">code .</span><br></pre></td></tr></table></figure></li>
<li>安装插件 <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">安装element-plus</span></span><br><span class="line">npm install element-plus --save</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">安装sass</span></span><br><span class="line">npm install sass -D</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">安装axios</span></span><br><span class="line">npm install axios</span><br></pre></td></tr></table></figure></li>
<li>删除 components 下自动生成的内容</li>
<li>新建目录 api、utils、views</li>
<li>将资料中的静态资源拷贝到 assets 目录下</li>
<li>删除App.vue中自动生成的内容</li>
<li>复制粘贴静态资源到 assets 目录下</li>
<li>将 request.js 复制粘贴到 utils 目录下 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定制请求的实例</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//导入axios  npm install axios</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span>;</span><br><span class="line"><span class="comment">//定义一个变量,记录公共的前缀  ,  baseURL</span></span><br><span class="line"><span class="keyword">const</span> baseURL = <span class="string">&#x27;http://localhost:8080&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> instance = axios.<span class="title function_">create</span>(&#123;baseURL&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//添加响应拦截器</span></span><br><span class="line">instance.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(</span><br><span class="line">    <span class="function"><span class="params">result</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> result.<span class="property">data</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="params">err</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&#x27;服务异常&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(err);<span class="comment">//异步的状态转化成失败的状态</span></span><br><span class="line">    &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> instance;</span><br></pre></td></tr></table></figure></li>
<li>在入口文件中导入 element-plus 和 静态资源 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./assets/main.scss&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ElementPlus</span> <span class="keyword">from</span> <span class="string">&#x27;element-plus&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;element-plus/dist/index.css&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">createApp</span>(<span class="title class_">App</span>)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title class_">ElementPlus</span>)</span><br><span class="line">app.<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="注册-1">注册</h3>
<h4 id="页面搭建">页面搭建</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; User, Lock &#125; from &#x27;@element-plus/icons-vue&#x27;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;</span><br><span class="line">//控制注册与登录表单的显示， 默认显示注册</span><br><span class="line">const isRegister = ref(false)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;el-row class=&quot;login-page&quot;&gt;</span><br><span class="line">        &lt;el-col :span=&quot;12&quot; class=&quot;bg&quot;&gt;&lt;/el-col&gt;</span><br><span class="line">        &lt;el-col :span=&quot;6&quot; :offset=&quot;3&quot; class=&quot;form&quot;&gt;</span><br><span class="line">            &lt;!-- 注册表单 --&gt;</span><br><span class="line">            &lt;el-form ref=&quot;form&quot; size=&quot;large&quot; autocomplete=&quot;off&quot; v-if=&quot;isRegister&quot;&gt;</span><br><span class="line">                &lt;el-form-item&gt;</span><br><span class="line">                    &lt;h1&gt;注册&lt;/h1&gt;</span><br><span class="line">                &lt;/el-form-item&gt;</span><br><span class="line">                &lt;el-form-item&gt;</span><br><span class="line">                    &lt;el-input :prefix-icon=&quot;User&quot; placeholder=&quot;请输入用户名&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">                &lt;/el-form-item&gt;</span><br><span class="line">                &lt;el-form-item&gt;</span><br><span class="line">                    &lt;el-input :prefix-icon=&quot;Lock&quot; type=&quot;password&quot; placeholder=&quot;请输入密码&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">                &lt;/el-form-item&gt;</span><br><span class="line">                &lt;el-form-item&gt;</span><br><span class="line">                    &lt;el-input :prefix-icon=&quot;Lock&quot; type=&quot;password&quot; placeholder=&quot;请输入再次密码&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">                &lt;/el-form-item&gt;</span><br><span class="line">                &lt;!-- 注册按钮 --&gt;</span><br><span class="line">                &lt;el-form-item&gt;</span><br><span class="line">                    &lt;el-button class=&quot;button&quot; type=&quot;primary&quot; auto-insert-space&gt;</span><br><span class="line">                        注册</span><br><span class="line">                    &lt;/el-button&gt;</span><br><span class="line">                &lt;/el-form-item&gt;</span><br><span class="line">                &lt;el-form-item class=&quot;flex&quot;&gt;</span><br><span class="line">                    &lt;el-link type=&quot;info&quot; :underline=&quot;false&quot; @click=&quot;isRegister = false&quot;&gt;</span><br><span class="line">                        ← 返回</span><br><span class="line">                    &lt;/el-link&gt;</span><br><span class="line">                &lt;/el-form-item&gt;</span><br><span class="line">            &lt;/el-form&gt;</span><br><span class="line">            &lt;!-- 登录表单 --&gt;</span><br><span class="line">            &lt;el-form ref=&quot;form&quot; size=&quot;large&quot; autocomplete=&quot;off&quot; v-else&gt;</span><br><span class="line">                &lt;el-form-item&gt;</span><br><span class="line">                    &lt;h1&gt;登录&lt;/h1&gt;</span><br><span class="line">                &lt;/el-form-item&gt;</span><br><span class="line">                &lt;el-form-item&gt;</span><br><span class="line">                    &lt;el-input :prefix-icon=&quot;User&quot; placeholder=&quot;请输入用户名&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">                &lt;/el-form-item&gt;</span><br><span class="line">                &lt;el-form-item&gt;</span><br><span class="line">                    &lt;el-input name=&quot;password&quot; :prefix-icon=&quot;Lock&quot; type=&quot;password&quot; placeholder=&quot;请输入密码&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">                &lt;/el-form-item&gt;</span><br><span class="line">                &lt;el-form-item class=&quot;flex&quot;&gt;</span><br><span class="line">                    &lt;div class=&quot;flex&quot;&gt;</span><br><span class="line">                        &lt;el-checkbox&gt;记住我&lt;/el-checkbox&gt;</span><br><span class="line">                        &lt;el-link type=&quot;primary&quot; :underline=&quot;false&quot;&gt;忘记密码？&lt;/el-link&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                &lt;/el-form-item&gt;</span><br><span class="line">                &lt;!-- 登录按钮 --&gt;</span><br><span class="line">                &lt;el-form-item&gt;</span><br><span class="line">                    &lt;el-button class=&quot;button&quot; type=&quot;primary&quot; auto-insert-space&gt;登录&lt;/el-button&gt;</span><br><span class="line">                &lt;/el-form-item&gt;</span><br><span class="line">                &lt;el-form-item class=&quot;flex&quot;&gt;</span><br><span class="line">                    &lt;el-link type=&quot;info&quot; :underline=&quot;false&quot; @click=&quot;isRegister = true&quot;&gt;</span><br><span class="line">                        注册 →</span><br><span class="line">                    &lt;/el-link&gt;</span><br><span class="line">                &lt;/el-form-item&gt;</span><br><span class="line">            &lt;/el-form&gt;</span><br><span class="line">        &lt;/el-col&gt;</span><br><span class="line">    &lt;/el-row&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">/* 样式 */</span><br><span class="line">.login-page &#123;</span><br><span class="line">    height: 100vh;</span><br><span class="line">    background-color: #fff;</span><br><span class="line"></span><br><span class="line">    .bg &#123;</span><br><span class="line">        background: url(&#x27;@/assets/logo2.png&#x27;) no-repeat 60% center / 240px auto,</span><br><span class="line">            url(&#x27;@/assets/login_bg.jpg&#x27;) no-repeat center / cover;</span><br><span class="line">        border-radius: 0 20px 20px 0;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .form &#123;</span><br><span class="line">        display: flex;</span><br><span class="line">        flex-direction: column;</span><br><span class="line">        justify-content: center;</span><br><span class="line">        user-select: none;</span><br><span class="line"></span><br><span class="line">        .title &#123;</span><br><span class="line">            margin: 0 auto;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .button &#123;</span><br><span class="line">            width: 100%;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .flex &#123;</span><br><span class="line">            width: 100%;</span><br><span class="line">            display: flex;</span><br><span class="line">            justify-content: space-between;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<h4 id="数据绑定">数据绑定</h4>
<ol type="1">
<li>添加数据模型 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义数据模型</span></span><br><span class="line"><span class="keyword">const</span> registerData = <span class="title function_">ref</span>(&#123;</span><br><span class="line">    <span class="attr">username</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="attr">password</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="attr">rePassword</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li>
<li>为注册表单的<code>&lt;el-form&gt;</code>添加<code>:model="registerData"</code>，为每个表单小件添加<code>v-model</code>，比如确认密码文本框<code>&lt;el-input&gt;</code>添加<code>v-model="registerData.rePassword"</code></li>
</ol>
<h4 id="表单校验">表单校验</h4>
<ol type="1">
<li>参照官方文档，定义表单校验规则，其中三个文本框都是把失焦事件作为触发器
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义表单校验规则</span></span><br><span class="line"><span class="keyword">const</span> rules = &#123;</span><br><span class="line">    <span class="attr">username</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">required</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">message</span>: <span class="string">&#x27;请输入用户名&#x27;</span>,</span><br><span class="line">            <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">min</span>: <span class="number">5</span>,</span><br><span class="line">            <span class="attr">max</span>: <span class="number">16</span>,</span><br><span class="line">            <span class="attr">message</span>: <span class="string">&#x27;长度为5~16位非空字符&#x27;</span>,</span><br><span class="line">            <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">password</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">required</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">message</span>: <span class="string">&#x27;请输入密码&#x27;</span>,</span><br><span class="line">            <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">min</span>: <span class="number">5</span>,</span><br><span class="line">            <span class="attr">max</span>: <span class="number">16</span>,</span><br><span class="line">            <span class="attr">message</span>: <span class="string">&#x27;长度为5~16位非空字符&#x27;</span>,</span><br><span class="line">            <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">rePassword</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">validator</span>: checkRePassword,</span><br><span class="line">            <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br></pre></td></tr></table></figure></li>
<li>其中<code>rePassword</code>比较特殊，参照官方文档，需要自定义校验规则，注意自定义校验函数需要写在使用者<code>rules</code>的前面
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//校验密码的函数</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">checkRePassword</span> = (<span class="params">rule, value, callback</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (value == <span class="string">&#x27;&#x27;</span>) &#123;</span><br><span class="line">        <span class="title function_">callback</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;请确认密码&#x27;</span>))</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (value !== registerData.<span class="property">value</span>.<span class="property">password</span>) &#123;</span><br><span class="line">        <span class="title function_">callback</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;请确保两次输入的密码一样&#x27;</span>))</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">callback</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>通过<code>&lt;el-form&gt;</code>添加<code>:rules="rules"</code>，绑定校验规则</li>
<li>通过<code>&lt;el-form-item&gt;</code>添加<code>props</code>，指定校验项，比如确认密码<code>prop="rePassword"</code></li>
</ol>
<h4 id="接口调用">接口调用</h4>
<ol type="1">
<li><p>在 api 文件夹中创建 user.js 文件，包括所有关于用户操作的 API
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入request.js请求工具</span></span><br><span class="line"><span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">&#x27;@/utils/request.js&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 提供调用注册接口的函数</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">userRegisterService</span> = (<span class="params">registerData</span>)=&gt;&#123;</span><br><span class="line">    <span class="comment">// 借助UrlSearchParams完成传递</span></span><br><span class="line">    <span class="keyword">const</span> params = <span class="keyword">new</span> <span class="title class_">URLSearchParams</span>()</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> key <span class="keyword">in</span> registerData)&#123;</span><br><span class="line">        params.<span class="title function_">append</span>(key, registerData[key])</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> request.<span class="title function_">post</span>(<span class="string">&#x27;/user/register&#x27;</span>, params)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
使用<code>URLSearchParams</code>是一种方便的方式，它能够帮助你将js对象转换为符合
URL
参数形式的字符串，这样就可以通过<code>params</code>对象得到一个符合<code>application/x-www-form-urlencoded</code>格式的字符串，否则axios将会自动把js对象转为json字符串请求出去</p></li>
<li><p>为注册按钮绑定点击事件<code>@click="register"</code>并具体实现
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;userRegisterService&#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/user.js&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用后台接口，完成注册</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">register</span> = <span class="keyword">async</span>(<span class="params"></span>)=&gt;&#123;</span><br><span class="line">    <span class="keyword">let</span> result = <span class="keyword">await</span> <span class="title function_">userRegisterService</span>(registerData.<span class="property">value</span>)</span><br><span class="line">    <span class="keyword">if</span>(result.<span class="property">code</span> == <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="comment">//成功</span></span><br><span class="line">        <span class="title function_">alert</span>(result.<span class="property">msg</span>?result.<span class="property">msg</span>:<span class="string">&#x27;注册成功&#x27;</span>)</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="comment">//失败</span></span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&#x27;注册失败&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></li>
</ol>
<h4 id="跨域问题">跨域问题</h4>
<ol type="1">
<li>将 request.js 中的公共前缀修改为<code>/api</code>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> baseURL = <span class="string">&#x27;/api&#x27;</span>;</span><br></pre></td></tr></table></figure></li>
<li>在 vite.config.js中添加代理 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server</span>:&#123;</span><br><span class="line">  <span class="attr">proxy</span>:&#123;</span><br><span class="line">    <span class="string">&#x27;/api&#x27;</span>:&#123; <span class="comment">//获取路径中包含了/api的请求</span></span><br><span class="line">        <span class="attr">target</span>:<span class="string">&#x27;http://localhost:8080&#x27;</span>, <span class="comment">//后台服务所在的源</span></span><br><span class="line">        <span class="attr">changeOrigin</span>:<span class="literal">true</span>, <span class="comment">//修改源</span></span><br><span class="line">        <span class="attr">rewrite</span>:<span class="function">(<span class="params">path</span>)=&gt;</span>path.<span class="title function_">replace</span>(<span class="regexp">/^\/api/</span>,<span class="string">&#x27;&#x27;</span>) <span class="comment">//api替换为空字符串</span></span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="登录-1">登录</h3>
<h4 id="数据绑定-1">数据绑定</h4>
<ol type="1">
<li>数据模型我们可以复用注册数据，为登录表单和表单组件绑定数据
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义数据模型</span></span><br><span class="line"><span class="keyword">const</span> registerData = <span class="title function_">ref</span>(&#123;</span><br><span class="line">    <span class="attr">username</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="attr">password</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="attr">rePassword</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure> 为登录表单绑定数据 <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-form</span> <span class="attr">...</span> <span class="attr">:model</span>=<span class="string">&quot;registerData&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure> 为表单组件绑定数据
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-input</span> <span class="attr">...</span> <span class="attr">v-model</span>=<span class="string">&quot;registerData.username&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>由于注册表单和登录表单共用一个数据模型，因此切换表单时，原来输入的数据会留在文本框中，所以需要在切换时清除数据，为返回按钮(链接)添加点击事件(已有点击事件的情况下，由于引号内实际上是js代码，所以按js代码的形式调用函数)，注册按钮(链接)同理
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-link</span> <span class="attr">type</span>=<span class="string">&quot;info&quot;</span> <span class="attr">:underline</span>=<span class="string">&quot;false&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;isRegister = false; clearRegisterData()&quot;</span>&gt;</span></span><br><span class="line">    ← 返回</span><br><span class="line"><span class="tag">&lt;/<span class="name">el-link</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">el-link</span> <span class="attr">type</span>=<span class="string">&quot;info&quot;</span> <span class="attr">:underline</span>=<span class="string">&quot;false&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;isRegister = true; clearRegisterData()&quot;</span>&gt;</span></span><br><span class="line">    注册 →</span><br><span class="line"><span class="tag">&lt;/<span class="name">el-link</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>实现清除数据的函数 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义函数，清空数据模型的数据</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">clearRegisterData</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    registerData.<span class="property">value</span> = &#123;</span><br><span class="line">        <span class="attr">username</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="attr">password</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="attr">rePassword</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="表单校验-1">表单校验</h4>
<ol type="1">
<li>我们也可以复用注册表单的校验规则，为表单赋予校验规则
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-form</span> <span class="attr">...</span> <span class="attr">:rules</span>=<span class="string">&quot;rules&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>为表单组件赋予对应的校验规则 <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">prop</span>=<span class="string">&quot;username&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">prop</span>=<span class="string">&quot;password&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="接口调用-1">接口调用</h4>
<ol type="1">
<li>为登录按钮赋予点击事件 <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-button</span> <span class="attr">class</span>=<span class="string">&quot;button&quot;</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">auto-insert-space</span> @<span class="attr">click</span>=<span class="string">&quot;login&quot;</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>实现事件函数 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//登录函数</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">login</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> result = <span class="keyword">await</span> <span class="title function_">userLoginService</span>(registerData.<span class="property">value</span>)</span><br><span class="line">    <span class="comment">//alert(result.msg ? result.msg : &#x27;登录成功&#x27;)</span></span><br><span class="line">    <span class="title class_">ElMessage</span>.<span class="title function_">success</span>(result.<span class="property">message</span> ? result.<span class="property">message</span> : <span class="string">&#x27;登录成功&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>在 user.js 中提供调用登录接口的函数 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//提供调用登录接口的函数</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">userLoginService</span> = (<span class="params">loginData</span>)=&gt;&#123;</span><br><span class="line">    <span class="comment">// 借助UrlSearchParams完成传递</span></span><br><span class="line">    <span class="keyword">const</span> params = <span class="keyword">new</span> <span class="title class_">URLSearchParams</span>()</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> key <span class="keyword">in</span> loginData)&#123;</span><br><span class="line">        params.<span class="title function_">append</span>(key, loginData[key])</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> request.<span class="title function_">post</span>(<span class="string">&#x27;/user/login&#x27;</span>, params)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure> ####
优化axios响应拦截器</li>
<li>我们可以使用 element-plus 的消息弹出框代替原生js的警告框，首先在
request.js 中引入组件 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ElMessage</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;element-plus&#x27;</span></span><br></pre></td></tr></table></figure></li>
<li>我们可以将每次的判断响应状态码封装到响应拦截器中 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">instance.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(</span><br><span class="line">    <span class="function"><span class="params">result</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">//判断业务状态码</span></span><br><span class="line">        <span class="keyword">if</span> (result.<span class="property">data</span>.<span class="property">code</span> === <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> result.<span class="property">data</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//操作失败</span></span><br><span class="line">        <span class="comment">//alert(result.data.msg ? result.data.msg : &#x27;操作失败&#x27;)</span></span><br><span class="line">        <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(result.<span class="property">data</span>.<span class="property">message</span> ? result.<span class="property">data</span>.<span class="property">message</span> : <span class="string">&#x27;操作失败&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(result.<span class="property">data</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&#x27;请求错误&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(err);<span class="comment">//异步的状态转化成失败的状态</span></span><br><span class="line">    &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
所以在调用接口函数的时候，可以省略状态码的判断了，直接处理拿到的数据，比如在调用注册接口的时候(别忘了引入<code>ElMessage</code>组件)
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 调用后台接口，完成注册</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">register</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> result = <span class="keyword">await</span> <span class="title function_">userRegisterService</span>(registerData.<span class="property">value</span>)</span><br><span class="line">    <span class="comment">//alert(result.msg ? result.msg : &#x27;注册成功&#x27;)</span></span><br><span class="line">    <span class="title class_">ElMessage</span>.<span class="title function_">success</span>(result.<span class="property">message</span> ? result.<span class="property">message</span> : <span class="string">&#x27;注册成功&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="主页面搭建和路由">主页面搭建和路由</h3>
<h4 id="主页面搭建">主页面搭建</h4>
<p>创建 Layout.vue 文件 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123;</span><br><span class="line">    Management,</span><br><span class="line">    Promotion,</span><br><span class="line">    UserFilled,</span><br><span class="line">    User,</span><br><span class="line">    Crop,</span><br><span class="line">    EditPen,</span><br><span class="line">    SwitchButton,</span><br><span class="line">    CaretBottom</span><br><span class="line">&#125; from &#x27;@element-plus/icons-vue&#x27;</span><br><span class="line">import avatar from &#x27;@/assets/default.png&#x27;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;el-container class=&quot;layout-container&quot;&gt;</span><br><span class="line">        &lt;!-- 左侧菜单 --&gt;</span><br><span class="line">        &lt;el-aside width=&quot;200px&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;el-aside__logo&quot;&gt;&lt;/div&gt;</span><br><span class="line">            &lt;el-menu active-text-color=&quot;#ffd04b&quot; background-color=&quot;#232323&quot;  text-color=&quot;#fff&quot;</span><br><span class="line">                router&gt;</span><br><span class="line">                &lt;el-menu-item &gt;</span><br><span class="line">                    &lt;el-icon&gt;</span><br><span class="line">                        &lt;Management /&gt;</span><br><span class="line">                    &lt;/el-icon&gt;</span><br><span class="line">                    &lt;span&gt;文章分类&lt;/span&gt;</span><br><span class="line">                &lt;/el-menu-item&gt;</span><br><span class="line">                &lt;el-menu-item &gt;</span><br><span class="line">                    &lt;el-icon&gt;</span><br><span class="line">                        &lt;Promotion /&gt;</span><br><span class="line">                    &lt;/el-icon&gt;</span><br><span class="line">                    &lt;span&gt;文章管理&lt;/span&gt;</span><br><span class="line">                &lt;/el-menu-item&gt;</span><br><span class="line">                &lt;el-sub-menu &gt;</span><br><span class="line">                    &lt;template #title&gt;</span><br><span class="line">                        &lt;el-icon&gt;</span><br><span class="line">                            &lt;UserFilled /&gt;</span><br><span class="line">                        &lt;/el-icon&gt;</span><br><span class="line">                        &lt;span&gt;个人中心&lt;/span&gt;</span><br><span class="line">                    &lt;/template&gt;</span><br><span class="line">                    &lt;el-menu-item &gt;</span><br><span class="line">                        &lt;el-icon&gt;</span><br><span class="line">                            &lt;User /&gt;</span><br><span class="line">                        &lt;/el-icon&gt;</span><br><span class="line">                        &lt;span&gt;基本资料&lt;/span&gt;</span><br><span class="line">                    &lt;/el-menu-item&gt;</span><br><span class="line">                    &lt;el-menu-item &gt;</span><br><span class="line">                        &lt;el-icon&gt;</span><br><span class="line">                            &lt;Crop /&gt;</span><br><span class="line">                        &lt;/el-icon&gt;</span><br><span class="line">                        &lt;span&gt;更换头像&lt;/span&gt;</span><br><span class="line">                    &lt;/el-menu-item&gt;</span><br><span class="line">                    &lt;el-menu-item &gt;</span><br><span class="line">                        &lt;el-icon&gt;</span><br><span class="line">                            &lt;EditPen /&gt;</span><br><span class="line">                        &lt;/el-icon&gt;</span><br><span class="line">                        &lt;span&gt;重置密码&lt;/span&gt;</span><br><span class="line">                    &lt;/el-menu-item&gt;</span><br><span class="line">                &lt;/el-sub-menu&gt;</span><br><span class="line">            &lt;/el-menu&gt;</span><br><span class="line">        &lt;/el-aside&gt;</span><br><span class="line">        &lt;!-- 右侧主区域 --&gt;</span><br><span class="line">        &lt;el-container&gt;</span><br><span class="line">            &lt;!-- 头部区域 --&gt;</span><br><span class="line">            &lt;el-header&gt;</span><br><span class="line">                &lt;div&gt;黑马程序员：&lt;strong&gt;东哥&lt;/strong&gt;&lt;/div&gt;</span><br><span class="line">                &lt;el-dropdown placement=&quot;bottom-end&quot;&gt;</span><br><span class="line">                    &lt;span class=&quot;el-dropdown__box&quot;&gt;</span><br><span class="line">                        &lt;el-avatar :src=&quot;avatar&quot; /&gt;</span><br><span class="line">                        &lt;el-icon&gt;</span><br><span class="line">                            &lt;CaretBottom /&gt;</span><br><span class="line">                        &lt;/el-icon&gt;</span><br><span class="line">                    &lt;/span&gt;</span><br><span class="line">                    &lt;template #dropdown&gt;</span><br><span class="line">                        &lt;el-dropdown-menu&gt;</span><br><span class="line">                            &lt;el-dropdown-item command=&quot;profile&quot; :icon=&quot;User&quot;&gt;基本资料&lt;/el-dropdown-item&gt;</span><br><span class="line">                            &lt;el-dropdown-item command=&quot;avatar&quot; :icon=&quot;Crop&quot;&gt;更换头像&lt;/el-dropdown-item&gt;</span><br><span class="line">                            &lt;el-dropdown-item command=&quot;password&quot; :icon=&quot;EditPen&quot;&gt;重置密码&lt;/el-dropdown-item&gt;</span><br><span class="line">                            &lt;el-dropdown-item command=&quot;logout&quot; :icon=&quot;SwitchButton&quot;&gt;退出登录&lt;/el-dropdown-item&gt;</span><br><span class="line">                        &lt;/el-dropdown-menu&gt;</span><br><span class="line">                    &lt;/template&gt;</span><br><span class="line">                &lt;/el-dropdown&gt;</span><br><span class="line">            &lt;/el-header&gt;</span><br><span class="line">            &lt;!-- 中间区域 --&gt;</span><br><span class="line">            &lt;el-main&gt;</span><br><span class="line">                &lt;div style=&quot;width: 1290px; height: 570px;border: 1px solid red;&quot;&gt;</span><br><span class="line">                    内容展示区</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">            &lt;/el-main&gt;</span><br><span class="line">            &lt;!-- 底部区域 --&gt;</span><br><span class="line">            &lt;el-footer&gt;大事件 ©2023 Created by 黑马程序员&lt;/el-footer&gt;</span><br><span class="line">        &lt;/el-container&gt;</span><br><span class="line">    &lt;/el-container&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.layout-container &#123;</span><br><span class="line">    height: 100vh;</span><br><span class="line"></span><br><span class="line">    .el-aside &#123;</span><br><span class="line">        background-color: #232323;</span><br><span class="line"></span><br><span class="line">        &amp;__logo &#123;</span><br><span class="line">            height: 120px;</span><br><span class="line">            background: url(&#x27;@/assets/logo.png&#x27;) no-repeat center / 120px auto;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .el-menu &#123;</span><br><span class="line">            border-right: none;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .el-header &#123;</span><br><span class="line">        background-color: #fff;</span><br><span class="line">        display: flex;</span><br><span class="line">        align-items: center;</span><br><span class="line">        justify-content: space-between;</span><br><span class="line"></span><br><span class="line">        .el-dropdown__box &#123;</span><br><span class="line">            display: flex;</span><br><span class="line">            align-items: center;</span><br><span class="line"></span><br><span class="line">            .el-icon &#123;</span><br><span class="line">                color: #999;</span><br><span class="line">                margin-left: 10px;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            &amp;:active,</span><br><span class="line">            &amp;:focus &#123;</span><br><span class="line">                outline: none;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .el-footer &#123;</span><br><span class="line">        display: flex;</span><br><span class="line">        align-items: center;</span><br><span class="line">        justify-content: center;</span><br><span class="line">        font-size: 14px;</span><br><span class="line">        color: #666;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
可以看到采用的左侧菜单和右侧主区域内的头部区域、中间区域和底部区域的布局</p>
<h4 id="路由的基本使用">路由的基本使用</h4>
<ol type="1">
<li><p>安装 vue-router <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install vue-router@4</span><br></pre></td></tr></table></figure></p></li>
<li><p>在 view 目录下分别创建 article 目录和 user 目录，并在其中分别创建
ArticleCategory.vue、ArticleManage.vue、UserAvatar.vue、UserInfo.vue和UserResetPassword.vue文件</p></li>
<li><p>在<code>src/router/index.js</code>中创建路由器，并导出。我们这里使用<code>history</code>模式，即请求路径中不会出现<code>#</code>号
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入vue-router</span></span><br><span class="line"><span class="keyword">import</span> &#123; createRouter, createWebHistory &#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入组件</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">LoginVue</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/Login.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">LayoutVue</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/Layout.vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ArticleCategoryVue</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/article/ArticleCategory.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ArticleManageVue</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/article/ArticleManage.vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">UserAvatarVue</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/user/UserAvatar.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">UserInfoVue</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/user/UserInfo.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">UserResetPasswordVue</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/user/UserResetPassword.vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义路由关系</span></span><br><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">    &#123; <span class="attr">path</span>: <span class="string">&quot;/login&quot;</span>, <span class="attr">component</span>: <span class="title class_">LoginVue</span> &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&quot;/&quot;</span>,</span><br><span class="line">        <span class="attr">component</span>: <span class="title class_">LayoutVue</span>,</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创键路由器</span></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>(&#123;</span><br><span class="line">    <span class="attr">history</span>: <span class="title function_">createWebHistory</span>(),</span><br><span class="line">    <span class="attr">routes</span>: routes</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导出路由</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router</span><br></pre></td></tr></table></figure></p></li>
<li><p>在入口文件中导入路由器并使用，由于我们将路由器配置文件取名为<code>index</code>，因此可以直接路径中的<code>/index.js</code>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&#x27;@/router&#x27;</span></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(router)</span><br></pre></td></tr></table></figure></p></li>
<li><p>在 App.vue
中声明<code>&lt;router-view&gt;</code>标签，展示组件内容
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure></p></li>
<li><p>在 Login.vue 实现切换路由器组件 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 引入使用路由器函数</span></span><br><span class="line"><span class="keyword">import</span> &#123; useRouter &#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">useRouter</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 登录函数</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">login</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 跳转到首页</span></span><br><span class="line">    router.<span class="title function_">push</span>(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></li>
</ol>
<h4 id="子路由">子路由</h4>
<ol type="1">
<li><p>由于 App.vue 包含两个路由 Login.vue 和 Layout.vue，其中
Layout.vue 包含
ArticleCategory.vue、ArticleManage.vue、UserAvatar.vue、UserInfo.vue和UserResetPassword.vue
子路由。因此我们需要再 Layout.vue中配置它们： <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义路由关系</span></span><br><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">    &#123; <span class="attr">path</span>: <span class="string">&quot;/login&quot;</span>, <span class="attr">component</span>: <span class="title class_">LoginVue</span> &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&quot;/&quot;</span>,</span><br><span class="line">        <span class="attr">component</span>: <span class="title class_">LayoutVue</span>,</span><br><span class="line">        <span class="attr">redirect</span>: <span class="string">&#x27;/article/manage&#x27;</span>,</span><br><span class="line">        <span class="attr">children</span>: [</span><br><span class="line">            &#123; <span class="attr">path</span>: <span class="string">&#x27;/article/category&#x27;</span>, <span class="attr">component</span>: <span class="title class_">ArticleCategoryVue</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">path</span>: <span class="string">&#x27;/article/manage&#x27;</span>, <span class="attr">component</span>: <span class="title class_">ArticleManageVue</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">path</span>: <span class="string">&#x27;/user/avatar&#x27;</span>, <span class="attr">component</span>: <span class="title class_">UserAvatarVue</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">path</span>: <span class="string">&#x27;/user/info&#x27;</span>, <span class="attr">component</span>: <span class="title class_">UserInfoVue</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">path</span>: <span class="string">&#x27;/user/resetPassword&#x27;</span>, <span class="attr">component</span>: <span class="title class_">UserResetPasswordVue</span> &#125;,</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
其中<code>redirect</code>用于重定向到指定的组件，即访问路径<code>/</code>，应该重定向到<code>/article/manage</code>；<code>children</code>用于配置子路由，其常用配置项和一般路由相似</p></li>
<li><p>在
Layout.vue中声明<code>&lt;router-view&gt;</code>标签，展示组件内容
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 中间区域 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">el-main</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- &lt;div style=&quot;width: 1290px; height: 570px;border: 1px solid red;&quot;&gt;</span></span><br><span class="line"><span class="comment">        内容展示区</span></span><br><span class="line"><span class="comment">    &lt;/div&gt; --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-main</span>&gt;</span></span><br></pre></td></tr></table></figure></p></li>
<li><p>在左侧菜单项添加<code>index</code>属性，用于设置点击后的路由路径
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-menu-item</span> <span class="attr">index</span>=<span class="string">&quot;/article/category&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-icon</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Management</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-icon</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>文章分类<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-menu-item</span>&gt;</span></span><br></pre></td></tr></table></figure></p></li>
</ol>
<h3 id="文章分类">文章分类</h3>
<h4 id="文章分类列表查询">文章分类列表查询</h4>
<ol type="1">
<li><p>复制以下代码到 ArticleCategory.vue 中 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123;</span><br><span class="line">    Edit,</span><br><span class="line">    Delete</span><br><span class="line">&#125; from &#x27;@element-plus/icons-vue&#x27;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;</span><br><span class="line">import &#123; articleCategoryListService &#125; from &#x27;@/api/article.js&#x27;</span><br><span class="line"></span><br><span class="line">const categorys = ref([</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;id&quot;: 3,</span><br><span class="line">        &quot;categoryName&quot;: &quot;美食&quot;,</span><br><span class="line">        &quot;categoryAlias&quot;: &quot;my&quot;,</span><br><span class="line">        &quot;createTime&quot;: &quot;2023-09-02 12:06:59&quot;,</span><br><span class="line">        &quot;updateTime&quot;: &quot;2023-09-02 12:06:59&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;id&quot;: 4,</span><br><span class="line">        &quot;categoryName&quot;: &quot;娱乐&quot;,</span><br><span class="line">        &quot;categoryAlias&quot;: &quot;yl&quot;,</span><br><span class="line">        &quot;createTime&quot;: &quot;2023-09-02 12:08:16&quot;,</span><br><span class="line">        &quot;updateTime&quot;: &quot;2023-09-02 12:08:16&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;id&quot;: 5,</span><br><span class="line">        &quot;categoryName&quot;: &quot;军事&quot;,</span><br><span class="line">        &quot;categoryAlias&quot;: &quot;js&quot;,</span><br><span class="line">        &quot;createTime&quot;: &quot;2023-09-02 12:08:33&quot;,</span><br><span class="line">        &quot;updateTime&quot;: &quot;2023-09-02 12:08:33&quot;</span><br><span class="line">    &#125;</span><br><span class="line">])</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;el-card class=&quot;page-container&quot;&gt;</span><br><span class="line">        &lt;template #header&gt;</span><br><span class="line">            &lt;div class=&quot;header&quot;&gt;</span><br><span class="line">                &lt;span&gt;文章分类&lt;/span&gt;</span><br><span class="line">                &lt;div class=&quot;extra&quot;&gt;</span><br><span class="line">                    &lt;el-button type=&quot;primary&quot;&gt;添加分类&lt;/el-button&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">        &lt;el-table :data=&quot;categorys&quot; style=&quot;width: 100%&quot;&gt;</span><br><span class="line">            &lt;el-table-column label=&quot;序号&quot; width=&quot;100&quot; type=&quot;index&quot;&gt; &lt;/el-table-column&gt;</span><br><span class="line">            &lt;el-table-column label=&quot;分类名称&quot; prop=&quot;categoryName&quot;&gt;&lt;/el-table-column&gt;</span><br><span class="line">            &lt;el-table-column label=&quot;分类别名&quot; prop=&quot;categoryAlias&quot;&gt;&lt;/el-table-column&gt;</span><br><span class="line">            &lt;el-table-column label=&quot;操作&quot; width=&quot;100&quot;&gt;</span><br><span class="line">                &lt;template #default=&quot;&#123; row &#125;&quot;&gt;</span><br><span class="line">                    &lt;el-button :icon=&quot;Edit&quot; circle plain type=&quot;primary&quot;&gt;&lt;/el-button&gt;</span><br><span class="line">                    &lt;el-button :icon=&quot;Delete&quot; circle plain type=&quot;danger&quot;&gt;&lt;/el-button&gt;</span><br><span class="line">                &lt;/template&gt;</span><br><span class="line">            &lt;/el-table-column&gt;</span><br><span class="line">            &lt;template #empty&gt;</span><br><span class="line">                &lt;el-empty description=&quot;没有数据&quot; /&gt;</span><br><span class="line">            &lt;/template&gt;</span><br><span class="line">        &lt;/el-table&gt;</span><br><span class="line">    &lt;/el-card&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.page-container &#123;</span><br><span class="line">    min-height: 100%;</span><br><span class="line">    box-sizing: border-box;</span><br><span class="line"></span><br><span class="line">    .header &#123;</span><br><span class="line">        display: flex;</span><br><span class="line">        align-items: center;</span><br><span class="line">        justify-content: space-between;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure></p></li>
<li><p>调用接口，将返回的数据赋值给数据模型 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 声明异步函数</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">articleCategoryList</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> result = <span class="keyword">await</span> <span class="title function_">articleCategoryListService</span>()</span><br><span class="line">    categorys.<span class="property">value</span> = result.<span class="property">data</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">articleCategoryList</span>()</span><br></pre></td></tr></table></figure></p></li>
<li><p>在 api 目录下新建 article.js ，并实现接口 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">&#x27;@/utils/request.js&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//文章分类列表查询</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">articleCategoryListService</span> = (<span class="params"></span>)=&gt;&#123;</span><br><span class="line">    <span class="keyword">return</span> request.<span class="title function_">get</span>(<span class="string">&#x27;/category&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
如果我们此时发送查询请求，其实是无法请求的，会返回 401
未授权错误，因为我们并没有携带 token 到后端</p></li>
</ol>
<h4 id="pinia状态管理库">Pinia状态管理库</h4>
<p>Pinia是Vue的专属状态管理库，它允许你跨组件或页面共享状态 1. 安装
pinia <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install pinia</span><br></pre></td></tr></table></figure></p>
<ol start="2" type="1">
<li><p>在入口文件中导入 pinia并使用 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createPinia &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"><span class="keyword">const</span> pinia = <span class="title function_">createPinia</span>()</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(pinia)</span><br></pre></td></tr></table></figure></p></li>
<li><p>在<code>src/stores/token.js</code>中定义 store
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义store</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * useTokenStore函数</span></span><br><span class="line"><span class="comment"> *   第一个参数：字符串，代表名字，具有唯一性</span></span><br><span class="line"><span class="comment"> *   第二个参数：函数，函数内部可以定义状态的所有内容</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * 返回值：函数，能调用该函数得到第二个参数函数的返回值内容</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useTokenStore = <span class="title function_">defineStore</span>(<span class="string">&#x27;token&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 定义状态的内容</span></span><br><span class="line">    <span class="comment">// 1. 响应式变量</span></span><br><span class="line">    <span class="keyword">const</span> token = <span class="title function_">ref</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2.定义一个函数，用于修改token的值</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">setToken</span> = (<span class="params">newToken</span>) =&gt; &#123;</span><br><span class="line">        token.<span class="property">value</span> = newToken</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. 定义一个函数，用于移除token的值</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">removeToken</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        token.<span class="property">value</span> = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 返回值</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        token, setToken, removeToken</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p></li>
<li><p>在 Login.vue 中将返回的 token 添加到 store 中
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useTokenStore &#125; <span class="keyword">from</span> <span class="string">&#x27;@/store/token.js&#x27;</span></span><br><span class="line"><span class="keyword">const</span> tokenStore = <span class="title function_">useTokenStore</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">//登录函数</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">login</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 把得到的token存储到pinia中</span></span><br><span class="line">    tokenStore.<span class="title function_">setToken</span>(result.<span class="property">data</span>)</span><br><span class="line">    <span class="comment">// 跳转到首页</span></span><br><span class="line">    router.<span class="title function_">push</span>(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></li>
<li><p>在 article.js 中的请求中携带 store 的 token
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">&#x27;@/utils/request.js&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useTokenStore &#125; <span class="keyword">from</span> <span class="string">&#x27;@/store/token.js&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//文章分类列表查询</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">articleCategoryListService</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> tokenStore = <span class="title function_">useTokenStore</span>()</span><br><span class="line">    <span class="comment">//在pinia中定义的响应式数据不需要.value</span></span><br><span class="line">    <span class="keyword">return</span> request.<span class="title function_">get</span>(<span class="string">&#x27;/category&#x27;</span>, &#123; <span class="attr">headers</span>: &#123; <span class="string">&#x27;Authorization&#x27;</span>: tokenStore.<span class="property">token</span> &#125; &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></li>
</ol>
<h4 id="axios请求拦截器">axios请求拦截器</h4>
<p>为了避免每次发起请求都要手动携带
token，我们可以定义请求拦截器，在请求发起前自动携带token
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useTokenStore &#125; <span class="keyword">from</span> <span class="string">&#x27;@/store/token.js&#x27;</span></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment">//添加请求拦截器</span></span><br><span class="line">instance.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(</span><br><span class="line">    <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">//请求前的回调</span></span><br><span class="line">        <span class="comment">//添加token</span></span><br><span class="line">        <span class="keyword">const</span> tokenStore = <span class="title function_">useTokenStore</span>()</span><br><span class="line">        <span class="comment">//判断有没有token</span></span><br><span class="line">        <span class="keyword">if</span> (tokenStore.<span class="property">token</span>) &#123;</span><br><span class="line">            config.<span class="property">headers</span>.<span class="property">Authorization</span> = tokenStore.<span class="property">token</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> config</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">//请求错误的回调</span></span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(err)</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<h4 id="pinia持久化插件persist">Pinia持久化插件：persist</h4>
<p>Pinia 默认是内存存储，当刷新浏览器的时候会丢失数据。Persist
插件可以将 pinia 中的数据持久化地存储 1. 安装 persist <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install pinia-persistedstate-plugin</span><br></pre></td></tr></table></figure> 2.
在入口文件中导入 persist 并<strong>在pinia中</strong>使用 persist
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createPersistedState &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia-persistedstate-plugin&#x27;</span></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> persist = <span class="title function_">createPersistedState</span>()</span><br><span class="line">pinia.<span class="title function_">use</span>(persist)</span><br></pre></td></tr></table></figure> 3. 在 token.js
中定义状态Store的函数中赋予<strong>第三个参数</strong>，用于持久化存储
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">persist</span>:<span class="literal">true</span> <span class="comment">//持久化存储</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="未登录统一处理">未登录统一处理</h4>
<p>在响应拦截器中判断响应状态码 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&#x27;@/router&#x27;</span> </span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">err =&gt; &#123;</span><br><span class="line">    <span class="comment">//判断响应状态码，如果为401，则表示未登录，提示请登录，并跳转到登录页面</span></span><br><span class="line">    <span class="keyword">if</span>(err.<span class="property">response</span>.<span class="property">status</span> === <span class="number">401</span>)&#123;</span><br><span class="line">        <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&#x27;请先登录&#x27;</span>)</span><br><span class="line">        router.<span class="title function_">push</span>(<span class="string">&#x27;/login&#x27;</span>)</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&#x27;服务异常&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(err);<span class="comment">//异步的状态转化成失败的状态</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="添加文章分类">添加文章分类</h4>
<ol type="1">
<li><p>添加文章分类弹窗 <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 添加分类弹窗 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">el-dialog</span> <span class="attr">v-model</span>=<span class="string">&quot;dialogVisible&quot;</span> <span class="attr">title</span>=<span class="string">&quot;添加弹层&quot;</span> <span class="attr">width</span>=<span class="string">&quot;30%&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">:model</span>=<span class="string">&quot;categoryModel&quot;</span> <span class="attr">:rules</span>=<span class="string">&quot;rules&quot;</span> <span class="attr">label-width</span>=<span class="string">&quot;100px&quot;</span> <span class="attr">style</span>=<span class="string">&quot;padding-right: 30px&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;分类名称&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;categoryName&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;categoryModel.categoryName&quot;</span> <span class="attr">minlength</span>=<span class="string">&quot;1&quot;</span> <span class="attr">maxlength</span>=<span class="string">&quot;10&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;分类别名&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;categoryAlias&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;categoryModel.categoryAlias&quot;</span> <span class="attr">minlength</span>=<span class="string">&quot;1&quot;</span> <span class="attr">maxlength</span>=<span class="string">&quot;15&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">template</span> #<span class="attr">footer</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;dialog-footer&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;dialogVisible = false&quot;</span>&gt;</span>取消<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;addCategory&quot;</span>&gt;</span> 确认 <span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-dialog</span>&gt;</span></span><br></pre></td></tr></table></figure></p></li>
<li><p>给弹窗进行数据绑定和添加表单校验 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//控制添加分类弹窗</span></span><br><span class="line"><span class="keyword">const</span> dialogVisible = <span class="title function_">ref</span>(<span class="literal">false</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//添加分类数据模型</span></span><br><span class="line"><span class="keyword">const</span> categoryModel = <span class="title function_">ref</span>(&#123;</span><br><span class="line">    <span class="attr">categoryName</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="attr">categoryAlias</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//添加分类表单校验</span></span><br><span class="line"><span class="keyword">const</span> rules = &#123;</span><br><span class="line">    <span class="attr">categoryName</span>: [</span><br><span class="line">        &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&#x27;请输入分类名称&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span> &#125;,</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">categoryAlias</span>: [</span><br><span class="line">        &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&#x27;请输入分类别名&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span> &#125;,</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></li>
<li><p>弹窗的显示隐藏依靠布尔值<code>dialogVisible</code>实现，为添加分类按钮添加点击事件<code>@click="dialogVisible = true"</code>，弹窗里的取消按钮已经添加好对应的点击事件了</p></li>
<li><p>为弹窗里的确认按钮添加点击事件用于添加文章分类<code>@click="addCategory"</code>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 添加文章分类</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">addCategory</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">//调用接口</span></span><br><span class="line">    <span class="keyword">let</span> result = <span class="keyword">await</span> <span class="title function_">articleCategoryAddService</span>(categoryModel.<span class="property">value</span>)</span><br><span class="line">    <span class="title class_">ElMessage</span>.<span class="title function_">success</span>(result.<span class="property">message</span>?result.<span class="property">message</span>:<span class="string">&#x27;添加成功&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//调用获取文章分类列表的函数(刷新一下)</span></span><br><span class="line">    <span class="title function_">articleCategoryList</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">//取消弹窗</span></span><br><span class="line">    dialogVisible.<span class="property">value</span> = <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></li>
<li><p>在 article.js 中实现接口 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//文章分类添加</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">articleCategoryAddService</span> = (<span class="params">categoryData</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> request.<span class="title function_">post</span>(<span class="string">&#x27;/category&#x27;</span>, categoryData)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></li>
<li><p>我们还需要每次点击添加分类按钮前清空数据模型 <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;dialogVisible = true; title = &#x27;添加分类&#x27;;clearModel()&quot;</span>&gt;</span>添加分类<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//清空数据模型</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">clearModel</span> = (<span class="params"></span>)=&gt;&#123;</span><br><span class="line">    categoryModel.<span class="property">value</span> = &#123;</span><br><span class="line">        <span class="attr">categoryName</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="attr">categoryAlias</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></li>
</ol>
<h4 id="编辑文章分类">编辑文章分类</h4>
<ol type="1">
<li><p>我们可以复用添加文章分类的弹窗，但是需要在添加或编辑时切换对应的弹窗标题，首先定义响应式数据
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义变量，用于控制弹窗标题的显示</span></span><br><span class="line"><span class="keyword">const</span> title = <span class="title function_">ref</span>(<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure></p></li>
<li><p>为弹窗绑定数据 <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 添加分类弹窗 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">el-dialog</span> <span class="attr">v-model</span>=<span class="string">&quot;dialogVisible&quot;</span> <span class="attr">:title</span>=<span class="string">&quot;title&quot;</span> <span class="attr">width</span>=<span class="string">&quot;30%&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure></p></li>
<li><p>在点击添加文章分类按钮时，将<code>title</code>修改为<code>添加分类</code>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;dialogVisible = true; title = &#x27;添加分类&#x27;&quot;</span>&gt;</span>添加分类<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br></pre></td></tr></table></figure></p></li>
<li><p>在点击编辑文章分类按钮时也是同理，但是我们需要点击之后在文本框中回显数据，逻辑比较多，因此封装到一个函数中。<code>row</code>可以获取当前行的数据，另外将行的<code>id</code>属性添加给分类数据模型，用于传递给后端
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-button</span> <span class="attr">:icon</span>=<span class="string">&quot;Edit&quot;</span> <span class="attr">circle</span> <span class="attr">plain</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;showDialog(row)&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br></pre></td></tr></table></figure> <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//展示编辑弹窗</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">showDialog</span> = row =&gt; &#123;</span><br><span class="line">    dialogVisible.<span class="property">value</span> = <span class="literal">true</span>;</span><br><span class="line">    title.<span class="property">value</span> = <span class="string">&#x27;编辑分类&#x27;</span></span><br><span class="line">    <span class="comment">//数据拷贝</span></span><br><span class="line">    categoryModel.<span class="property">value</span>.<span class="property">categoryName</span> = row.<span class="property">categoryName</span>;</span><br><span class="line">    categoryModel.<span class="property">value</span>.<span class="property">categoryAlias</span> = row.<span class="property">categoryAlias</span>;</span><br><span class="line">    <span class="comment">//添加id属性，用于传递给后端</span></span><br><span class="line">    categoryModel.<span class="property">value</span>.<span class="property">id</span> = row.<span class="property">id</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></li>
<li><p>由于我们添加和修改共用了弹窗，因此弹窗的确认按钮需要判断应该发送什么请求，我们可以根据<code>title</code>的值进行判断
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;title == &#x27;添加分类&#x27; ? addCategory() : updateCategory()&quot;</span>&gt;</span> 确认 <span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br></pre></td></tr></table></figure></p></li>
<li><p>实现<code>updateCategory</code>方法 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 编辑文章分类</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">updateCategory</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> result = <span class="title function_">articleCategoryUpdateService</span>(categoryModel.<span class="property">value</span>)</span><br><span class="line">    <span class="title class_">ElMessage</span>.<span class="title function_">success</span>(result.<span class="property">message</span> ? result.<span class="property">message</span> : <span class="string">&#x27;修改成功&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//调用获取文章分类列表的函数(刷新一下)</span></span><br><span class="line">    <span class="title function_">articleCategoryList</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment">//取消弹窗</span></span><br><span class="line">    dialogVisible.<span class="property">value</span> = <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></li>
<li><p>提供修改文章分类的接口 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//文章分类修改</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">articleCategoryUpdateService</span> = (<span class="params">categoryData</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> request.<span class="title function_">put</span>(<span class="string">&#x27;/category&#x27;</span>, categoryData)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></li>
</ol>
<h4 id="删除文章分类">删除文章分类</h4>
<ol type="1">
<li><p>为删除按钮赋予点击事件，并传递本行数据 <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-button</span> <span class="attr">:icon</span>=<span class="string">&quot;Delete&quot;</span> <span class="attr">circle</span> <span class="attr">plain</span> <span class="attr">type</span>=<span class="string">&quot;danger&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;deleteCategory(row)&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br></pre></td></tr></table></figure></p></li>
<li><p>我们在方法中使用element-plus的消息弹出框，用于提示用户是否确认删除
引入消息提示框 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ElMessage</span>, <span class="title class_">ElMessageBox</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;element-plus&#x27;</span></span><br></pre></td></tr></table></figure>
在方法内使用，参考官方文档，将英语文本改成需要的文本，然后调用删除接口
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 删除文章分类</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">deleteCategory</span> = (<span class="params">row</span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// 提示用户确认框</span></span><br><span class="line">    <span class="title class_">ElMessageBox</span>.<span class="title function_">confirm</span>(</span><br><span class="line">        <span class="string">&#x27;确认删除该文章分类吗？&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;温馨提示&#x27;</span>,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">confirmButtonText</span>: <span class="string">&#x27;确认&#x27;</span>,</span><br><span class="line">            <span class="attr">cancelButtonText</span>: <span class="string">&#x27;取消&#x27;</span>,</span><br><span class="line">            <span class="attr">type</span>: <span class="string">&#x27;warning&#x27;</span>,</span><br><span class="line">        &#125;)</span><br><span class="line">        .<span class="title function_">then</span>(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">            <span class="keyword">let</span> result = <span class="keyword">await</span> <span class="title function_">articleCategoryDeleteService</span>(row.<span class="property">id</span>)</span><br><span class="line">            <span class="title class_">ElMessage</span>.<span class="title function_">success</span>(result.<span class="property">message</span> ? result.<span class="property">message</span> : <span class="string">&#x27;删除成功&#x27;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment">//调用获取文章分类列表的函数(刷新一下)</span></span><br><span class="line">            <span class="title function_">articleCategoryList</span>()</span><br><span class="line">        &#125;)</span><br><span class="line">        .<span class="title function_">catch</span>(<span class="function">() =&gt;</span> &#123; &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></li>
<li><p>提供删除接口，因为需要请求的格式是<code>queryString</code>，所以直接通过拼接字符串发起请求
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//文章分类删除</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">articleCategoryDeleteService</span> = (<span class="params">id</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> request.<span class="title function_">delete</span>(<span class="string">&#x27;/category?id=&#x27;</span> + id)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></li>
</ol>
<h3 id="文章">文章</h3>
<h4 id="文章列表查询">文章列表查询</h4>
<ol type="1">
<li><p>页面的搭建，复制如下代码到 ArticleManage.vue 中
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123;</span><br><span class="line">    Edit,</span><br><span class="line">    Delete</span><br><span class="line">&#125; from &#x27;@element-plus/icons-vue&#x27;</span><br><span class="line"></span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;</span><br><span class="line"></span><br><span class="line">//文章分类数据模型</span><br><span class="line">const categorys = ref([</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;id&quot;: 3,</span><br><span class="line">        &quot;categoryName&quot;: &quot;美食&quot;,</span><br><span class="line">        &quot;categoryAlias&quot;: &quot;my&quot;,</span><br><span class="line">        &quot;createTime&quot;: &quot;2023-09-02 12:06:59&quot;,</span><br><span class="line">        &quot;updateTime&quot;: &quot;2023-09-02 12:06:59&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;id&quot;: 4,</span><br><span class="line">        &quot;categoryName&quot;: &quot;娱乐&quot;,</span><br><span class="line">        &quot;categoryAlias&quot;: &quot;yl&quot;,</span><br><span class="line">        &quot;createTime&quot;: &quot;2023-09-02 12:08:16&quot;,</span><br><span class="line">        &quot;updateTime&quot;: &quot;2023-09-02 12:08:16&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;id&quot;: 5,</span><br><span class="line">        &quot;categoryName&quot;: &quot;军事&quot;,</span><br><span class="line">        &quot;categoryAlias&quot;: &quot;js&quot;,</span><br><span class="line">        &quot;createTime&quot;: &quot;2023-09-02 12:08:33&quot;,</span><br><span class="line">        &quot;updateTime&quot;: &quot;2023-09-02 12:08:33&quot;</span><br><span class="line">    &#125;</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">//用户搜索时选中的分类id</span><br><span class="line">const categoryId=ref(&#x27;&#x27;)</span><br><span class="line"></span><br><span class="line">//用户搜索时选中的发布状态</span><br><span class="line">const state=ref(&#x27;&#x27;)</span><br><span class="line"></span><br><span class="line">//文章列表数据模型</span><br><span class="line">const articles = ref([</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;id&quot;: 5,</span><br><span class="line">        &quot;title&quot;: &quot;陕西旅游攻略&quot;,</span><br><span class="line">        &quot;content&quot;: &quot;兵马俑,华清池,法门寺,华山...爱去哪去哪...&quot;,</span><br><span class="line">        &quot;coverImg&quot;: &quot;https://big-event-gwd.oss-cn-beijing.aliyuncs.com/9bf1cf5b-1420-4c1b-91ad-e0f4631cbed4.png&quot;,</span><br><span class="line">        &quot;state&quot;: &quot;草稿&quot;,</span><br><span class="line">        &quot;categoryId&quot;: 2,</span><br><span class="line">        &quot;createTime&quot;: &quot;2023-09-03 11:55:30&quot;,</span><br><span class="line">        &quot;updateTime&quot;: &quot;2023-09-03 11:55:30&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;id&quot;: 5,</span><br><span class="line">        &quot;title&quot;: &quot;陕西旅游攻略&quot;,</span><br><span class="line">        &quot;content&quot;: &quot;兵马俑,华清池,法门寺,华山...爱去哪去哪...&quot;,</span><br><span class="line">        &quot;coverImg&quot;: &quot;https://big-event-gwd.oss-cn-beijing.aliyuncs.com/9bf1cf5b-1420-4c1b-91ad-e0f4631cbed4.png&quot;,</span><br><span class="line">        &quot;state&quot;: &quot;草稿&quot;,</span><br><span class="line">        &quot;categoryId&quot;: 2,</span><br><span class="line">        &quot;createTime&quot;: &quot;2023-09-03 11:55:30&quot;,</span><br><span class="line">        &quot;updateTime&quot;: &quot;2023-09-03 11:55:30&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;id&quot;: 5,</span><br><span class="line">        &quot;title&quot;: &quot;陕西旅游攻略&quot;,</span><br><span class="line">        &quot;content&quot;: &quot;兵马俑,华清池,法门寺,华山...爱去哪去哪...&quot;,</span><br><span class="line">        &quot;coverImg&quot;: &quot;https://big-event-gwd.oss-cn-beijing.aliyuncs.com/9bf1cf5b-1420-4c1b-91ad-e0f4631cbed4.png&quot;,</span><br><span class="line">        &quot;state&quot;: &quot;草稿&quot;,</span><br><span class="line">        &quot;categoryId&quot;: 2,</span><br><span class="line">        &quot;createTime&quot;: &quot;2023-09-03 11:55:30&quot;,</span><br><span class="line">        &quot;updateTime&quot;: &quot;2023-09-03 11:55:30&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">//分页条数据模型</span><br><span class="line">const pageNum = ref(1)//当前页</span><br><span class="line">const total = ref(20)//总条数</span><br><span class="line">const pageSize = ref(3)//每页条数</span><br><span class="line"></span><br><span class="line">//当每页条数发生了变化，调用此函数</span><br><span class="line">const onSizeChange = (size) =&gt; &#123;</span><br><span class="line">    pageSize.value = size</span><br><span class="line">&#125;</span><br><span class="line">//当前页码发生变化，调用此函数</span><br><span class="line">const onCurrentChange = (num) =&gt; &#123;</span><br><span class="line">    pageNum.value = num</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;el-card class=&quot;page-container&quot;&gt;</span><br><span class="line">        &lt;template #header&gt;</span><br><span class="line">            &lt;div class=&quot;header&quot;&gt;</span><br><span class="line">                &lt;span&gt;文章管理&lt;/span&gt;</span><br><span class="line">                &lt;div class=&quot;extra&quot;&gt;</span><br><span class="line">                    &lt;el-button type=&quot;primary&quot;&gt;添加文章&lt;/el-button&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">        &lt;!-- 搜索表单 --&gt;</span><br><span class="line">        &lt;el-form inline&gt;</span><br><span class="line">            &lt;el-form-item label=&quot;文章分类：&quot;&gt;</span><br><span class="line">                &lt;el-select placeholder=&quot;请选择&quot; v-model=&quot;categoryId&quot;&gt;</span><br><span class="line">                    &lt;el-option </span><br><span class="line">                        v-for=&quot;c in categorys&quot; </span><br><span class="line">                        :key=&quot;c.id&quot; </span><br><span class="line">                        :label=&quot;c.categoryName&quot;</span><br><span class="line">                        :value=&quot;c.id&quot;&gt;</span><br><span class="line">                    &lt;/el-option&gt;</span><br><span class="line">                &lt;/el-select&gt;</span><br><span class="line">            &lt;/el-form-item&gt;</span><br><span class="line"></span><br><span class="line">            &lt;el-form-item label=&quot;发布状态：&quot;&gt;</span><br><span class="line">                &lt;el-select placeholder=&quot;请选择&quot; v-model=&quot;state&quot;&gt;</span><br><span class="line">                    &lt;el-option label=&quot;已发布&quot; value=&quot;已发布&quot;&gt;&lt;/el-option&gt;</span><br><span class="line">                    &lt;el-option label=&quot;草稿&quot; value=&quot;草稿&quot;&gt;&lt;/el-option&gt;</span><br><span class="line">                &lt;/el-select&gt;</span><br><span class="line">            &lt;/el-form-item&gt;</span><br><span class="line">            &lt;el-form-item&gt;</span><br><span class="line">                &lt;el-button type=&quot;primary&quot;&gt;搜索&lt;/el-button&gt;</span><br><span class="line">                &lt;el-button&gt;重置&lt;/el-button&gt;</span><br><span class="line">            &lt;/el-form-item&gt;</span><br><span class="line">        &lt;/el-form&gt;</span><br><span class="line">        &lt;!-- 文章列表 --&gt;</span><br><span class="line">        &lt;el-table :data=&quot;articles&quot; style=&quot;width: 100%&quot;&gt;</span><br><span class="line">            &lt;el-table-column label=&quot;文章标题&quot; width=&quot;400&quot; prop=&quot;title&quot;&gt;&lt;/el-table-column&gt;</span><br><span class="line">            &lt;el-table-column label=&quot;分类&quot; prop=&quot;categoryId&quot;&gt;&lt;/el-table-column&gt;</span><br><span class="line">            &lt;el-table-column label=&quot;发表时间&quot; prop=&quot;createTime&quot;&gt; &lt;/el-table-column&gt;</span><br><span class="line">            &lt;el-table-column label=&quot;状态&quot; prop=&quot;state&quot;&gt;&lt;/el-table-column&gt;</span><br><span class="line">            &lt;el-table-column label=&quot;操作&quot; width=&quot;100&quot;&gt;</span><br><span class="line">                &lt;template #default=&quot;&#123; row &#125;&quot;&gt;</span><br><span class="line">                    &lt;el-button :icon=&quot;Edit&quot; circle plain type=&quot;primary&quot;&gt;&lt;/el-button&gt;</span><br><span class="line">                    &lt;el-button :icon=&quot;Delete&quot; circle plain type=&quot;danger&quot;&gt;&lt;/el-button&gt;</span><br><span class="line">                &lt;/template&gt;</span><br><span class="line">            &lt;/el-table-column&gt;</span><br><span class="line">            &lt;template #empty&gt;</span><br><span class="line">                &lt;el-empty description=&quot;没有数据&quot; /&gt;</span><br><span class="line">            &lt;/template&gt;</span><br><span class="line">        &lt;/el-table&gt;</span><br><span class="line">        &lt;!-- 分页条 --&gt;</span><br><span class="line">        &lt;el-pagination v-model:current-page=&quot;pageNum&quot; v-model:page-size=&quot;pageSize&quot; :page-sizes=&quot;[3, 5 ,10, 15]&quot;</span><br><span class="line">            layout=&quot;jumper, total, sizes, prev, pager, next&quot; background :total=&quot;total&quot; @size-change=&quot;onSizeChange&quot;</span><br><span class="line">            @current-change=&quot;onCurrentChange&quot; style=&quot;margin-top: 20px; justify-content: flex-end&quot; /&gt;</span><br><span class="line">    &lt;/el-card&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.page-container &#123;</span><br><span class="line">    min-height: 100%;</span><br><span class="line">    box-sizing: border-box;</span><br><span class="line"></span><br><span class="line">    .header &#123;</span><br><span class="line">        display: flex;</span><br><span class="line">        align-items: center;</span><br><span class="line">        justify-content: space-between;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure></p></li>
<li><p>使用中文语言包，解决分页条中文问题，在 main.js
中添加(修改)以下代码 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> locale <span class="keyword">from</span> <span class="string">&#x27;element-plus/dist/locale/zh-cn.js&#x27;</span></span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title class_">ElementPlus</span>,&#123;locale&#125;)</span><br></pre></td></tr></table></figure></p></li>
<li><p>文章分类数据回显，调用查询文章分类接口即可
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//文章列表查询</span></span><br><span class="line"><span class="keyword">import</span> &#123; articleCategoryListService &#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/article.js&#x27;</span></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment">// 回显文章分类</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">articleCategoryList</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> result = <span class="keyword">await</span> <span class="title function_">articleCategoryListService</span>()</span><br><span class="line">    categorys.<span class="property">value</span> = result.<span class="property">data</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//setup执行时执行一次查询</span></span><br><span class="line"><span class="title function_">articleCategoryList</span>()</span><br></pre></td></tr></table></figure></p></li>
<li><p>在 article.js 中提供获取文章列表的接口 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//文章列表查询</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">articleListService</span> = (<span class="params">params</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> request.<span class="title function_">get</span>(<span class="string">&#x27;/article&#x27;</span>, &#123; <span class="attr">params</span>: params &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></li>
<li><p>调用接口获取数据，其中分类id和状态是可有可无的数据，因此需要判断是否存在，如果存在则传给<code>params</code>对象。由于列表中展示的是分类id，我们可以通过比对的方式显示对应的分类名称
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取文章分页数据</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">articleList</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> params = &#123;</span><br><span class="line">        <span class="attr">pageNum</span>: pageNum.<span class="property">value</span>,</span><br><span class="line">        <span class="attr">pageSize</span>: pageSize.<span class="property">value</span>,</span><br><span class="line">        <span class="attr">categoryId</span>: categoryId.<span class="property">value</span> ? categoryId.<span class="property">value</span> : <span class="literal">null</span>,</span><br><span class="line">        <span class="attr">state</span>: state.<span class="property">value</span> ? state.<span class="property">value</span> : <span class="literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> result = <span class="keyword">await</span> <span class="title function_">articleListService</span>(params)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//渲染视图</span></span><br><span class="line">    total.<span class="property">value</span> = result.<span class="property">data</span>.<span class="property">total</span></span><br><span class="line">    articles.<span class="property">value</span> = result.<span class="property">data</span>.<span class="property">items</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//为列表中添加categoryName属性</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; articles.<span class="property">value</span>.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">let</span> article = articles.<span class="property">value</span>[i];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; categorys.<span class="property">value</span>.<span class="property">length</span>; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (article.<span class="property">categoryId</span> === categorys.<span class="property">value</span>[j].<span class="property">id</span>) &#123;</span><br><span class="line">                article.<span class="property">categoryName</span> = categorys.<span class="property">value</span>[j].<span class="property">categoryName</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//setup执行时执行一次查询</span></span><br><span class="line"><span class="title function_">articleList</span>()</span><br></pre></td></tr></table></figure></p></li>
<li><p>可以看到分页条中有两个自定义事件，即当分页条的当前页和每页条数发生变化时，重新发起请求获取数据
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//当每页条数发生了变化，调用此函数</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">onSizeChange</span> = (<span class="params">size</span>) =&gt; &#123;</span><br><span class="line">    pageSize.<span class="property">value</span> = size</span><br><span class="line">    <span class="title function_">getArticles</span>()</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//当前页码发生变化，调用此函数</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">onCurrentChange</span> = (<span class="params">num</span>) =&gt; &#123;</span><br><span class="line">    pageNum.<span class="property">value</span> = num</span><br><span class="line">    <span class="title function_">getArticles</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></li>
<li><p>为搜索按钮绑定点击事件，调用<code>getArticles</code>函数即可
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;getArticles&quot;</span>&gt;</span>搜索<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br></pre></td></tr></table></figure></p></li>
<li><p>为重置按钮绑定单击事件，清除<code>categoryId</code>和<code>state</code>的值，并调用<code>getArticles</code>函数
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;categoryId = &#x27;&#x27;; state = &#x27;&#x27;;articleList()&quot;</span>&gt;</span>重置<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br></pre></td></tr></table></figure></p></li>
</ol>
<h4 id="添加文章">添加文章</h4>
<ol type="1">
<li><p>页面搭建，通过抽屉组件添加文章 <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 抽屉 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-drawer</span> <span class="attr">v-model</span>=<span class="string">&quot;visibleDrawer&quot;</span> <span class="attr">title</span>=<span class="string">&quot;添加文章&quot;</span> <span class="attr">direction</span>=<span class="string">&quot;rtl&quot;</span> <span class="attr">size</span>=<span class="string">&quot;50%&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 添加文章表单 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">:model</span>=<span class="string">&quot;articleModel&quot;</span> <span class="attr">label-width</span>=<span class="string">&quot;100px&quot;</span> &gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;文章标题&quot;</span> &gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;articleModel.title&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请输入标题&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;文章分类&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">el-select</span> <span class="attr">placeholder</span>=<span class="string">&quot;请选择&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;articleModel.categoryId&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">v-for</span>=<span class="string">&quot;c in categorys&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;c.id&quot;</span> <span class="attr">:label</span>=<span class="string">&quot;c.categoryName&quot;</span> <span class="attr">:value</span>=<span class="string">&quot;c.id&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">el-option</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">el-select</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;文章封面&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">el-upload</span> <span class="attr">class</span>=<span class="string">&quot;avatar-uploader&quot;</span> <span class="attr">:auto-upload</span>=<span class="string">&quot;false&quot;</span> <span class="attr">:show-file-list</span>=<span class="string">&quot;false&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">img</span> <span class="attr">v-if</span>=<span class="string">&quot;articleModel.coverImg&quot;</span> <span class="attr">:src</span>=<span class="string">&quot;articleModel.coverImg&quot;</span> <span class="attr">class</span>=<span class="string">&quot;avatar&quot;</span> /&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">el-icon</span> <span class="attr">v-else</span> <span class="attr">class</span>=<span class="string">&quot;avatar-uploader-icon&quot;</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">Plus</span> /&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">el-icon</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">el-upload</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;文章内容&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;editor&quot;</span>&gt;</span>富文本编辑器<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span>&gt;</span>发布<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;info&quot;</span>&gt;</span>草稿<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-drawer</span>&gt;</span></span><br></pre></td></tr></table></figure></p></li>
<li><p>为页面绑定数据 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">Plus</span>&#125; <span class="keyword">from</span> <span class="string">&#x27;@element-plus/icons-vue&#x27;</span></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment">//控制抽屉是否显示</span></span><br><span class="line"><span class="keyword">const</span> visibleDrawer = <span class="title function_">ref</span>(<span class="literal">false</span>)</span><br><span class="line"><span class="comment">//添加表单数据模型</span></span><br><span class="line"><span class="keyword">const</span> articleModel = <span class="title function_">ref</span>(&#123;</span><br><span class="line">    <span class="attr">title</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="attr">categoryId</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="attr">coverImg</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="attr">content</span>:<span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="attr">state</span>:<span class="string">&#x27;&#x27;</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p></li>
<li><p>为页面添加样式 <figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 抽屉样式 */</span></span><br><span class="line"><span class="selector-class">.avatar-uploader</span> &#123;</span><br><span class="line">    :<span class="built_in">deep</span>() &#123;</span><br><span class="line">        <span class="selector-class">.avatar</span> &#123;</span><br><span class="line">            <span class="attribute">width</span>: <span class="number">178px</span>;</span><br><span class="line">            <span class="attribute">height</span>: <span class="number">178px</span>;</span><br><span class="line">            <span class="attribute">display</span>: block;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="selector-class">.el-upload</span> &#123;</span><br><span class="line">            <span class="attribute">border</span>: <span class="number">1px</span> dashed <span class="built_in">var</span>(--el-border-color);</span><br><span class="line">            <span class="attribute">border-radius</span>: <span class="number">6px</span>;</span><br><span class="line">            <span class="attribute">cursor</span>: pointer;</span><br><span class="line">            <span class="attribute">position</span>: relative;</span><br><span class="line">            <span class="attribute">overflow</span>: hidden;</span><br><span class="line">            <span class="attribute">transition</span>: <span class="built_in">var</span>(--el-transition-duration-fast);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="selector-class">.el-upload</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">            <span class="attribute">border-color</span>: <span class="built_in">var</span>(--el-color-primary);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="selector-class">.el-icon</span><span class="selector-class">.avatar-uploader-icon</span> &#123;</span><br><span class="line">            <span class="attribute">font-size</span>: <span class="number">28px</span>;</span><br><span class="line">            <span class="attribute">color</span>: <span class="number">#8c939d</span>;</span><br><span class="line">            <span class="attribute">width</span>: <span class="number">178px</span>;</span><br><span class="line">            <span class="attribute">height</span>: <span class="number">178px</span>;</span><br><span class="line">            <span class="attribute">text-align</span>: center;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.editor</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  :<span class="built_in">deep</span>(.ql-editor) &#123;</span><br><span class="line">    <span class="attribute">min-height</span>: <span class="number">200px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></li>
<li><p>为添加文章按钮赋予点击事件<code>@click="visibleDrawer = true</code>展示抽屉</p></li>
<li><p>文章内容中需要使用到富文本编辑器，我们这里使用开源富文本编辑器
Quill</p></li>
</ol>
<blockquote>
<p>官网地址：https://vueup.github.io/vue-quill/</p>
</blockquote>
<p>安装： <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install @vueup/vue-quill@latest --save</span><br></pre></td></tr></table></figure></p>
<p>导入组件和样式(样式已经导入，就是上面的<code>.editor</code>)
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">QuillEditor</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@vueup/vue-quill&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;@vueup/vue-quill/dist/vue-quill.snow.css&#x27;</span></span><br></pre></td></tr></table></figure></p>
<p>在页面中使用 Quill 组件 <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;editor&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">quill-editor</span> <span class="attr">theme</span>=<span class="string">&quot;snow&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;articleModel.content&quot;</span> <span class="attr">contentType</span>=<span class="string">&quot;html&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">quill-editor</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<ol start="6" type="1">
<li>当点击“+”图标，选择本地图片后，<code>el-upload</code>这个组件会自动发送请求，把图片上传到指定的服务器上，而不需要我们自己使用axios发送异步请求，所以需要给<code>el-upload</code>标签添加一些属性，控制请求的发送，我们需要关注以下属性(API)
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;文章封面&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        auto-upload：设置是否自动上传</span></span><br><span class="line"><span class="comment">        action：设置服务器端口路径</span></span><br><span class="line"><span class="comment">        name：设置上传的文件字段名</span></span><br><span class="line"><span class="comment">        headers：设置上传的请求头</span></span><br><span class="line"><span class="comment">        on-success：设置上传成功的回调函数</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-upload</span> <span class="attr">class</span>=<span class="string">&quot;avatar-uploader&quot;</span> <span class="attr">:auto-upload</span>=<span class="string">&quot;true&quot;</span> <span class="attr">:show-file-list</span>=<span class="string">&quot;false&quot;</span> <span class="attr">action</span>=<span class="string">&quot;/api/upload&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">name</span>=<span class="string">&quot;file&quot;</span> <span class="attr">:headers</span>=<span class="string">&quot;&#123; Authorization: tokenStore.token &#125;&quot;</span> <span class="attr">:on-success</span>=<span class="string">&quot;uploadSuccess&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">v-if</span>=<span class="string">&quot;articleModel.coverImg&quot;</span> <span class="attr">:src</span>=<span class="string">&quot;articleModel.coverImg&quot;</span> <span class="attr">class</span>=<span class="string">&quot;avatar&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-icon</span> <span class="attr">v-else</span> <span class="attr">class</span>=<span class="string">&quot;avatar-uploader-icon&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">Plus</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-icon</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-upload</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br></pre></td></tr></table></figure>
注意虽然是自动发起请求，但同样会有跨域问题，因此在<code>action</code>属性中需要添加<code>/api</code>；</li>
</ol>
<p>在<code>headers</code>属性中绑定请求头的时候也需要导入 Pinia 状态
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useTokenStore &#125; <span class="keyword">from</span> <span class="string">&#x27;@/store/token.js&#x27;</span></span><br><span class="line"><span class="comment">// 导入token</span></span><br><span class="line"><span class="keyword">const</span> tokenStore = <span class="title function_">useTokenStore</span>()</span><br></pre></td></tr></table></figure></p>
<p>在<code>on-success</code>属性中绑定请求成功后的回调函数，这里我们接收后端返回的图片地址进行回显
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 上传成功的回调函数</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">uploadSuccess</span> = (<span class="params">result</span>) =&gt; &#123;</span><br><span class="line">    articleModel.<span class="property">value</span>.<span class="property">coverImg</span> = result.<span class="property">data</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<ol start="7" type="1">
<li><p>在 article.js 中提供添加文章的接口 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//文章添加</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">articleAddService</span> = (<span class="params">articleData</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> request.<span class="title function_">post</span>(<span class="string">&#x27;/article&#x27;</span>, articleData)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></li>
<li><p>点击“发布”和“草稿”时都是添加文章，可以调用同一个函数，我们可以通过传参的方式区分两者
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;addArticle(&#x27;已发布&#x27;)&quot;</span>&gt;</span>发布<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;info&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;addArticle(&#x27;草稿&#x27;)&quot;</span>&gt;</span>草稿<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br></pre></td></tr></table></figure></p></li>
<li><p>实现函数 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//添加文章</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">addArticle</span> = <span class="keyword">async</span> (<span class="params">articleState</span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">//把发布状态赋值给数据模型</span></span><br><span class="line">    articleModel.<span class="property">value</span>.<span class="property">state</span> = articleState</span><br><span class="line"></span><br><span class="line">    <span class="comment">//调用接口</span></span><br><span class="line">    <span class="keyword">let</span> result = <span class="keyword">await</span> <span class="title function_">articleAddService</span>(articleModel.<span class="property">value</span>)</span><br><span class="line">    <span class="title class_">ElMessage</span>.<span class="title function_">success</span>(result.<span class="property">message</span> ? result.<span class="property">message</span> : <span class="string">&#x27;添加成功&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//隐藏抽屉</span></span><br><span class="line">    visibleDrawer.<span class="property">value</span> = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//刷新当前文章列表</span></span><br><span class="line">    <span class="title function_">articleList</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></li>
</ol>
<h3 id="顶部导航栏个人信息">顶部导航栏个人信息</h3>
<p>在 Layout.vue
中，页面加载完就会发送请求获取个人信息并展示，因为需要在个人中心修改信息的时候还需要使用，因此还需要将个人信息存储到
pinia 中 1. 在 user.js 中提供获取个人信息的函数 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取个人信息</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">userInfoGetService</span> = (<span class="params"></span>)=&gt;&#123;</span><br><span class="line">    <span class="keyword">return</span> request.<span class="title function_">get</span>(<span class="string">&#x27;/user/userInfo&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<ol start="2" type="1">
<li><p>在<code>src/store/userInfo.js</code>中定义个人信息状态
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useUserInfoStore = <span class="title function_">defineStore</span>(<span class="string">&#x27;userInfo&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">//定义状态相关的内容</span></span><br><span class="line">    <span class="keyword">const</span> info = <span class="title function_">ref</span>(&#123;&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//修改用户信息状态</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">setInfo</span> = (<span class="params">newInfo</span>) =&gt; &#123;</span><br><span class="line">        info.<span class="property">value</span> = newInfo</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//清除用户信息状态</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">removeInfo</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        info.<span class="property">value</span> = &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        info,</span><br><span class="line">        setInfo,</span><br><span class="line">        removeInfo</span><br><span class="line">    &#125;</span><br><span class="line">&#125;, &#123;</span><br><span class="line">    <span class="attr">persist</span>: <span class="literal">true</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p></li>
<li><p>在 Layout.vue 中调用接口，将获取到的个人信息存储到 pinia 中
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; userInfoService &#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/user.js&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useUserInfoStore &#125; <span class="keyword">from</span> <span class="string">&#x27;@/store/userInfo.js&#x27;</span></span><br><span class="line"><span class="keyword">const</span> userInfoStore = <span class="title function_">useUserInfoStore</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取用户详细信息</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">getUserInfo</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> result = <span class="keyword">await</span> <span class="title function_">userInfoService</span>()</span><br><span class="line">    <span class="comment">//将结果存储到pinia中</span></span><br><span class="line">    userInfoStore.<span class="title function_">setInfo</span>(result.<span class="property">data</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">getUserInfo</span>()</span><br></pre></td></tr></table></figure></p></li>
<li><p>在 Layout.vue的顶部导航栏中展示昵称和头像 <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>黑马程序员：<span class="tag">&lt;<span class="name">strong</span>&gt;</span>&#123;&#123; userInfoStore.info.nickname &#125;&#125;<span class="tag">&lt;/<span class="name">strong</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-avatar</span> <span class="attr">:src</span>=<span class="string">&quot;userInfoStore.info.userPic ? userInfoStore.info.userPic : avatar&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure></p></li>
</ol>
<h3 id="个人中心">个人中心</h3>
<h4 id="el-dropdown功能实现"><code>el-dropdown</code>功能实现</h4>
<p>在<code>el-dropdown</code>中有四个子条目，分别是：基本资料、更换头像、重置密码、退出登录。其中前三个起到路由功能，跟左侧菜单中的是同样功能，而退出登录需要删除本地
pinia 存储的 token 以及 个人信息</p>
<blockquote>
<p>参考文档：https://element-plus.org/zh-CN/component/dropdown.html#dropdown-events</p>
</blockquote>
<ol type="1">
<li>在<code>el-dropdown</code>标签中绑定<code>@command</code>事件，表示当有条目被点击时会触发该事件
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-dropdown</span> <span class="attr">placement</span>=<span class="string">&quot;bottom-end&quot;</span> @<span class="attr">command</span>=<span class="string">&quot;handleCommand&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>在<code>el-dropdown-item</code>表前中添加<code>command</code>属性，该属性值会作为参数携带到<code>@command</code>事件回调函数中
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-dropdown-item</span> <span class="attr">command</span>=<span class="string">&quot;info&quot;</span> <span class="attr">:icon</span>=<span class="string">&quot;User&quot;</span>&gt;</span>基本资料<span class="tag">&lt;/<span class="name">el-dropdown-item</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">el-dropdown-item</span> <span class="attr">command</span>=<span class="string">&quot;avatar&quot;</span> <span class="attr">:icon</span>=<span class="string">&quot;Crop&quot;</span>&gt;</span>更换头像<span class="tag">&lt;/<span class="name">el-dropdown-item</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">el-dropdown-item</span> <span class="attr">command</span>=<span class="string">&quot;resetPassword&quot;</span> <span class="attr">:icon</span>=<span class="string">&quot;EditPen&quot;</span>&gt;</span>重置密码<span class="tag">&lt;/<span class="name">el-dropdown-item</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">el-dropdown-item</span> <span class="attr">command</span>=<span class="string">&quot;logout&quot;</span> <span class="attr">:icon</span>=<span class="string">&quot;SwitchButton&quot;</span>&gt;</span>退出登录<span class="tag">&lt;/<span class="name">el-dropdown-item</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>实现<code>handleCommand</code>函数 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;useRouter&#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ElMessage</span>,<span class="title class_">ElMessageBox</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;element-plus&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useTokenStore &#125; <span class="keyword">from</span> <span class="string">&#x27;@/stores/token.js&#x27;</span></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">useRouter</span>()</span><br><span class="line"><span class="keyword">const</span> tokenStore = <span class="title function_">useTokenStore</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 下拉框条目被点击后调用的函数</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">handleCommand</span> = (<span class="params">command</span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">//判断指令</span></span><br><span class="line">    <span class="keyword">if</span> (command === <span class="string">&#x27;logout&#x27;</span>) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 提示用户确认框</span></span><br><span class="line">        <span class="title class_">ElMessageBox</span>.<span class="title function_">confirm</span>(</span><br><span class="line">            <span class="string">&#x27;确认退出？&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;温馨提示&#x27;</span>,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">confirmButtonText</span>: <span class="string">&#x27;确认&#x27;</span>,</span><br><span class="line">                <span class="attr">cancelButtonText</span>: <span class="string">&#x27;取消&#x27;</span>,</span><br><span class="line">                <span class="attr">type</span>: <span class="string">&#x27;warning&#x27;</span>,</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="comment">//退出登录</span></span><br><span class="line">            .<span class="title function_">then</span>(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">                <span class="comment">//清空pinia中存储的token及个人信息</span></span><br><span class="line">                tokenStore.<span class="title function_">removeToken</span>()</span><br><span class="line">                userInfoStore.<span class="title function_">removeInfo</span>()</span><br><span class="line">                </span><br><span class="line">                <span class="comment">//跳转到登录页面</span></span><br><span class="line">                router.<span class="title function_">push</span>(<span class="string">&#x27;/login&#x27;</span>)</span><br><span class="line"></span><br><span class="line">                <span class="title class_">ElMessage</span>.<span class="title function_">success</span>(result.<span class="property">message</span> ? result.<span class="property">message</span> : <span class="string">&#x27;退出成功&#x27;</span>)</span><br><span class="line">            &#125;)</span><br><span class="line">            .<span class="title function_">catch</span>(<span class="function">() =&gt;</span> &#123; &#125;)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">//路由跳转</span></span><br><span class="line">        router.<span class="title function_">push</span>(<span class="string">&#x27;/user/&#x27;</span> + command)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="基本资料修改">基本资料修改</h4>
<ol type="1">
<li><p>复制以下代码到 UserInfo.vue <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;</span><br><span class="line">const userInfo = ref(&#123;</span><br><span class="line">    id: 0,</span><br><span class="line">    username: &#x27;zhangsan&#x27;,</span><br><span class="line">    nickname: &#x27;zs&#x27;,</span><br><span class="line">    email: &#x27;zs@163.com&#x27;,</span><br><span class="line">&#125;)</span><br><span class="line">const rules = &#123;</span><br><span class="line">    nickname: [</span><br><span class="line">        &#123; required: true, message: &#x27;请输入用户昵称&#x27;, trigger: &#x27;blur&#x27; &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            pattern: /^\S&#123;2,10&#125;$/,</span><br><span class="line">            message: &#x27;昵称必须是2-10位的非空字符串&#x27;,</span><br><span class="line">            trigger: &#x27;blur&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    email: [</span><br><span class="line">        &#123; required: true, message: &#x27;请输入用户邮箱&#x27;, trigger: &#x27;blur&#x27; &#125;,</span><br><span class="line">        &#123; type: &#x27;email&#x27;, message: &#x27;邮箱格式不正确&#x27;, trigger: &#x27;blur&#x27; &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;el-card class=&quot;page-container&quot;&gt;</span><br><span class="line">        &lt;template #header&gt;</span><br><span class="line">            &lt;div class=&quot;header&quot;&gt;</span><br><span class="line">                &lt;span&gt;基本资料&lt;/span&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">        &lt;el-row&gt;</span><br><span class="line">            &lt;el-col :span=&quot;12&quot;&gt;</span><br><span class="line">                &lt;el-form :model=&quot;userInfo&quot; :rules=&quot;rules&quot; label-width=&quot;100px&quot; size=&quot;large&quot;&gt;</span><br><span class="line">                    &lt;el-form-item label=&quot;登录名称&quot;&gt;</span><br><span class="line">                        &lt;el-input v-model=&quot;userInfo.username&quot; disabled&gt;&lt;/el-input&gt;</span><br><span class="line">                    &lt;/el-form-item&gt;</span><br><span class="line">                    &lt;el-form-item label=&quot;用户昵称&quot; prop=&quot;nickname&quot;&gt;</span><br><span class="line">                        &lt;el-input v-model=&quot;userInfo.nickname&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">                    &lt;/el-form-item&gt;</span><br><span class="line">                    &lt;el-form-item label=&quot;用户邮箱&quot; prop=&quot;email&quot;&gt;</span><br><span class="line">                        &lt;el-input v-model=&quot;userInfo.email&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">                    &lt;/el-form-item&gt;</span><br><span class="line">                    &lt;el-form-item&gt;</span><br><span class="line">                        &lt;el-button type=&quot;primary&quot;&gt;提交修改&lt;/el-button&gt;</span><br><span class="line">                    &lt;/el-form-item&gt;</span><br><span class="line">                &lt;/el-form&gt;</span><br><span class="line">            &lt;/el-col&gt;</span><br><span class="line">        &lt;/el-row&gt;</span><br><span class="line">    &lt;/el-card&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure></p></li>
<li><p>表单数据回显 个人信息在一开始登录到系统中就会保存在 pinia
中，因此只需要从 pinia 中获取个人信息并替换模板数据
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useUserInfoStore &#125; <span class="keyword">from</span> <span class="string">&#x27;@/stores/user.js&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> userInfoStore = <span class="title function_">useUserInfoStore</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> userInfo = <span class="title function_">ref</span>(&#123;...userInfoStore.<span class="property">info</span>&#125;)</span><br></pre></td></tr></table></figure></p></li>
<li><p>在<code>src/api/user.js</code>中提供修改基本资料的接口
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//修改个人信息</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">userInfoUpdateService</span> = (<span class="params">userInfo</span>)=&gt;&#123;</span><br><span class="line">    <span class="keyword">return</span> request.<span class="title function_">put</span>(<span class="string">&#x27;/user/update&#x27;</span>,userInfo)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></li>
<li><p>为修改按钮绑定点击事件 <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;updateUserInfo&quot;</span>&gt;</span>提交修改<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br></pre></td></tr></table></figure></p></li>
<li><p>调用接口，实现<code>updateUserInfo</code>函数
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;userInfoUpdateService&#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/user.js&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ElMessage</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;element-plus&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 修改用户信息</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">updateUserInfo</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> result = <span class="keyword">await</span> <span class="title function_">userInfoUpdateService</span>(userInfo.<span class="property">value</span>)</span><br><span class="line"></span><br><span class="line">    <span class="title class_">ElMessage</span>.<span class="title function_">success</span>(result.<span class="property">message</span>?result.<span class="property">message</span>:<span class="string">&#x27;修改成功&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//修改pinia中的用户信息</span></span><br><span class="line">    userInfoStore.<span class="title function_">setInfo</span>(userInfo.<span class="property">value</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></li>
</ol>
<h4 id="修改头像">修改头像</h4>
<ol type="1">
<li><p>复制以下代码到 UserAvatar.vue 中 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; Plus, Upload &#125; from &#x27;@element-plus/icons-vue&#x27;</span><br><span class="line">import &#123;ref&#125; from &#x27;vue&#x27;</span><br><span class="line">import avatar from &#x27;@/assets/default.png&#x27;</span><br><span class="line">const uploadRef = ref()</span><br><span class="line"></span><br><span class="line">//用户头像地址</span><br><span class="line">const imgUrl= avatar</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;el-card class=&quot;page-container&quot;&gt;</span><br><span class="line">        &lt;template #header&gt;</span><br><span class="line">            &lt;div class=&quot;header&quot;&gt;</span><br><span class="line">                &lt;span&gt;更换头像&lt;/span&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">        &lt;el-row&gt;</span><br><span class="line">            &lt;el-col :span=&quot;12&quot;&gt;</span><br><span class="line">                &lt;el-upload </span><br><span class="line">                    ref=&quot;uploadRef&quot;</span><br><span class="line">                    class=&quot;avatar-uploader&quot; </span><br><span class="line">                    :show-file-list=&quot;false&quot;</span><br><span class="line">                    &gt;</span><br><span class="line">                    &lt;img v-if=&quot;imgUrl&quot; :src=&quot;imgUrl&quot; class=&quot;avatar&quot; /&gt;</span><br><span class="line">                    &lt;img v-else src=&quot;avatar&quot; width=&quot;278&quot; /&gt;</span><br><span class="line">                &lt;/el-upload&gt;</span><br><span class="line">                &lt;br /&gt;</span><br><span class="line">                &lt;el-button type=&quot;primary&quot; :icon=&quot;Plus&quot; size=&quot;large&quot;  @click=&quot;uploadRef.$el.querySelector(&#x27;input&#x27;).click()&quot;&gt;</span><br><span class="line">                    选择图片</span><br><span class="line">                &lt;/el-button&gt;</span><br><span class="line">                &lt;el-button type=&quot;success&quot; :icon=&quot;Upload&quot; size=&quot;large&quot;&gt;</span><br><span class="line">                    上传头像</span><br><span class="line">                &lt;/el-button&gt;</span><br><span class="line">            &lt;/el-col&gt;</span><br><span class="line">        &lt;/el-row&gt;</span><br><span class="line">    &lt;/el-card&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.avatar-uploader &#123;</span><br><span class="line">    :deep() &#123;</span><br><span class="line">        .avatar &#123;</span><br><span class="line">            width: 278px;</span><br><span class="line">            height: 278px;</span><br><span class="line">            display: block;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .el-upload &#123;</span><br><span class="line">            border: 1px dashed var(--el-border-color);</span><br><span class="line">            border-radius: 6px;</span><br><span class="line">            cursor: pointer;</span><br><span class="line">            position: relative;</span><br><span class="line">            overflow: hidden;</span><br><span class="line">            transition: var(--el-transition-duration-fast);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .el-upload:hover &#123;</span><br><span class="line">            border-color: var(--el-color-primary);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        .el-icon.avatar-uploader-icon &#123;</span><br><span class="line">            font-size: 28px;</span><br><span class="line">            color: #8c939d;</span><br><span class="line">            width: 278px;</span><br><span class="line">            height: 278px;</span><br><span class="line">            text-align: center;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure></p></li>
<li><p>在 pinia 中读取用户的头像数据 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//读取用户信息</span></span><br><span class="line"><span class="keyword">import</span> &#123;ref&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;useUserInfoStore&#125; <span class="keyword">from</span> <span class="string">&#x27;@/stores/user.js&#x27;</span></span><br><span class="line"><span class="keyword">const</span> userInfoStore = <span class="title function_">useUserInfoStore</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> imgUrl=<span class="title function_">ref</span>(userInfoStore.<span class="property">info</span>.<span class="property">userPic</span>)</span><br></pre></td></tr></table></figure>
在<code>img</code>标签上绑定图片地址 <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">v-if</span>=<span class="string">&quot;imgUrl&quot;</span> <span class="attr">:src</span>=<span class="string">&quot;imgUrl&quot;</span> <span class="attr">class</span>=<span class="string">&quot;avatar&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">v-else</span> <span class="attr">:src</span>=<span class="string">&quot;avatar&quot;</span> <span class="attr">width</span>=<span class="string">&quot;278&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure></p></li>
<li><p>为<code>el-upload</code>指定属性值，和上传文章图片一样
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-upload</span> <span class="attr">ref</span>=<span class="string">&quot;uploadRef&quot;</span> <span class="attr">class</span>=<span class="string">&quot;avatar-uploader&quot;</span> <span class="attr">:show-file-list</span>=<span class="string">&quot;false&quot;</span> <span class="attr">:auto-upload</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">action</span>=<span class="string">&quot;/api/upload&quot;</span> <span class="attr">name</span>=<span class="string">&quot;file&quot;</span> <span class="attr">:headers</span>=<span class="string">&quot;&#123; &#x27;Authorization&#x27;: tokenStore.token &#125;&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:on-success</span>=<span class="string">&quot;uploadSuccess&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">v-if</span>=<span class="string">&quot;imgUrl&quot;</span> <span class="attr">:src</span>=<span class="string">&quot;imgUrl&quot;</span> <span class="attr">class</span>=<span class="string">&quot;avatar&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">v-else</span> <span class="attr">:src</span>=<span class="string">&quot;avatar&quot;</span> <span class="attr">width</span>=<span class="string">&quot;278&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-upload</span>&gt;</span></span><br></pre></td></tr></table></figure></p></li>
<li><p>提供上传成功的回调函数 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//读取token信息</span></span><br><span class="line"><span class="keyword">import</span> &#123;useTokenStore&#125; <span class="keyword">from</span> <span class="string">&#x27;@/stores/token.js&#x27;</span></span><br><span class="line"><span class="keyword">const</span> tokenStore = <span class="title function_">useTokenStore</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">//图片上传成功的回调</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">uploadSuccess</span> = (<span class="params">result</span>)=&gt;&#123;</span><br><span class="line">    <span class="comment">//回显图片</span></span><br><span class="line">    imgUrl.<span class="property">value</span> = result.<span class="property">data</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></li>
<li><p>外部触发图片上传，即获取到<code>el-upload</code>组件，通过<code>$el.querySelector('input')</code>获取到<code>el-upload</code>对应的元素，触发<code>click</code>事件
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取el-upload元素</span></span><br><span class="line"><span class="keyword">const</span> uploadRef = <span class="title function_">ref</span>()</span><br></pre></td></tr></table></figure> <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">:icon</span>=<span class="string">&quot;Plus&quot;</span> <span class="attr">size</span>=<span class="string">&quot;large&quot;</span>  @<span class="attr">click</span>=<span class="string">&quot;uploadRef.$el.querySelector(&#x27;input&#x27;).click()&quot;</span>&gt;</span></span><br><span class="line">    选择图片</span><br><span class="line"><span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br></pre></td></tr></table></figure></p></li>
<li><p>为上传头像按钮绑定点击事件 <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;success&quot;</span> <span class="attr">:icon</span>=<span class="string">&quot;Upload&quot;</span> <span class="attr">size</span>=<span class="string">&quot;large&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;updateAvatar&quot;</span>&gt;</span></span><br><span class="line">    上传头像</span><br><span class="line"><span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br></pre></td></tr></table></figure></p></li>
<li><p>调用接口，实现<code>updateAvatar</code>函数
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;userAvatarUpdateService&#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/user.js&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">ElMessage</span>&#125; <span class="keyword">from</span> <span class="string">&#x27;element-plus&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 更新头像</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">updateAvatar</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> result = <span class="keyword">await</span> <span class="title function_">userAvatarUpdateService</span>(imgUrl.<span class="property">value</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//修改pinia中的状态</span></span><br><span class="line">    userInfoStore.<span class="property">info</span>.<span class="property">userPic</span> = imgUrl.<span class="property">value</span></span><br><span class="line"></span><br><span class="line">    <span class="title class_">ElMessage</span>.<span class="title function_">success</span>(result.<span class="property">message</span> ? result.<span class="property">message</span> : <span class="string">&#x27;更换成功&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></li>
<li><p>在 user.js 中提供修改头像的函数 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 修改用户头像</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">userAvatarUpdateService</span> = (<span class="params">avatarUrl</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> request.<span class="title function_">patch</span>(<span class="string">&#x27;/user/updateAvatar?avatarUrl=&#x27;</span> + avatarUrl)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></li>
</ol>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>糖泥
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://1354478648.github.io/2023/11/10/SpringBoot%E5%92%8CVue%E7%9A%84%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91%E6%95%99%E7%A8%8B/" title="SpringBoot和Vue的全栈开发教程">http://1354478648.github.io/2023/11/10/SpringBoot和Vue的全栈开发教程/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/zh-CN" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E5%89%8D%E7%AB%AF/" rel="tag"># 前端</a>
              <a href="/tags/%E5%90%8E%E7%AB%AF/" rel="tag"># 后端</a>
              <a href="/tags/Java/" rel="tag"># Java</a>
              <a href="/tags/Spring/" rel="tag"># Spring</a>
              <a href="/tags/Vue/" rel="tag"># Vue</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2023/10/30/%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4%E7%B0%BF/" rel="prev" title="常用指令簿">
      <i class="fa fa-chevron-left"></i> 常用指令簿
    </a></div>
      <div class="post-nav-item">
    <a href="/2023/11/29/Vue3%E4%B8%ADaxios%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8%E4%B8%8E%E5%B0%81%E8%A3%85/" rel="next" title="Vue3中axios的基本使用与封装">
      Vue3中axios的基本使用与封装 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%8D%E4%B9%A0%E4%B8%80%E4%B8%8B%E5%90%8E%E7%AB%AF"><span class="nav-number">1.</span> <span class="nav-text">复习一下后端</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#springboot%E5%B7%A5%E7%A8%8B%E5%88%9B%E5%BB%BA"><span class="nav-number">1.1.</span> <span class="nav-text">SpringBoot工程创建</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-number">1.2.</span> <span class="nav-text">配置文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B4%E5%90%88mybatis"><span class="nav-number">1.3.</span> <span class="nav-text">整合MyBatis</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%A7%E4%BA%8B%E4%BB%B6%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91"><span class="nav-number">2.</span> <span class="nav-text">大事件项目开发</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%A8%E6%88%B7%E7%9B%B8%E5%85%B3%E6%8E%A5%E5%8F%A3"><span class="nav-number">2.1.</span> <span class="nav-text">用户相关接口</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B3%A8%E5%86%8C"><span class="nav-number">2.1.1.</span> <span class="nav-text">注册</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%99%BB%E5%BD%95"><span class="nav-number">2.1.2.</span> <span class="nav-text">登录</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#jwt%E8%AF%A6%E8%A7%A3"><span class="nav-number">2.1.2.1.</span> <span class="nav-text">JWT详解</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81"><span class="nav-number">2.1.2.2.</span> <span class="nav-text">登录认证</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E7%94%A8%E6%88%B7%E8%AF%A6%E7%BB%86%E4%BF%A1%E6%81%AF"><span class="nav-number">2.1.3.</span> <span class="nav-text">获取用户详细信息</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#threadlocal%E4%BC%98%E5%8C%96"><span class="nav-number">2.1.3.1.</span> <span class="nav-text">Threadlocal优化</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9B%B4%E6%96%B0%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF"><span class="nav-number">2.1.4.</span> <span class="nav-text">更新用户信息</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9B%B4%E6%96%B0%E7%94%A8%E6%88%B7%E5%A4%B4%E5%83%8F"><span class="nav-number">2.1.4.1.</span> <span class="nav-text">更新用户头像</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9B%B4%E6%96%B0%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81"><span class="nav-number">2.1.4.2.</span> <span class="nav-text">更新用户密码</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E7%B1%BB%E7%9B%B8%E5%85%B3%E6%8E%A5%E5%8F%A3"><span class="nav-number">2.2.</span> <span class="nav-text">分类相关接口</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B0%E5%A2%9E%E5%88%86%E7%B1%BB"><span class="nav-number">2.2.1.</span> <span class="nav-text">新增分类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9F%A5%E8%AF%A2%E5%88%86%E7%B1%BB"><span class="nav-number">2.2.2.</span> <span class="nav-text">查询分类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9F%A5%E8%AF%A2%E5%88%86%E7%B1%BB%E8%AF%A6%E6%83%85"><span class="nav-number">2.2.3.</span> <span class="nav-text">查询分类详情</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E5%88%86%E7%B1%BB"><span class="nav-number">2.2.4.</span> <span class="nav-text">删除分类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9B%B4%E6%96%B0%E5%88%86%E7%B1%BB"><span class="nav-number">2.2.5.</span> <span class="nav-text">更新分类</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%86%E7%BB%84%E6%A0%A1%E9%AA%8C"><span class="nav-number">2.2.5.1.</span> <span class="nav-text">分组校验</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E7%AB%A0%E7%9B%B8%E5%85%B3%E6%8E%A5%E5%8F%A3"><span class="nav-number">2.3.</span> <span class="nav-text">文章相关接口</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B0%E5%A2%9E%E6%96%87%E7%AB%A0"><span class="nav-number">2.3.1.</span> <span class="nav-text">新增文章</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%B3%A8%E8%A7%A3"><span class="nav-number">2.3.1.1.</span> <span class="nav-text">自定义注解</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%87%E7%AB%A0%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2"><span class="nav-number">2.3.2.</span> <span class="nav-text">文章分页查询</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E6%96%87%E7%AB%A0%E8%AF%A6%E6%83%85"><span class="nav-number">2.3.3.</span> <span class="nav-text">获取文章详情</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9B%B4%E6%96%B0%E6%96%87%E7%AB%A0"><span class="nav-number">2.3.4.</span> <span class="nav-text">更新文章</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E6%96%87%E7%AB%A0"><span class="nav-number">2.3.5.</span> <span class="nav-text">删除文章</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%8E%A5%E5%8F%A3"><span class="nav-number">2.4.</span> <span class="nav-text">文件上传接口</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%AC%E5%9C%B0%E5%AD%98%E5%82%A8"><span class="nav-number">2.4.1.</span> <span class="nav-text">本地存储</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%98%BF%E9%87%8C%E4%BA%91oss%E5%AD%98%E5%82%A8%E6%96%87%E4%BB%B6"><span class="nav-number">2.4.2.</span> <span class="nav-text">阿里云OSS存储文件</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%99%BB%E5%BD%95%E4%BC%98%E5%8C%96"><span class="nav-number">2.5.</span> <span class="nav-text">登录优化</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="nav-number">2.5.1.</span> <span class="nav-text">代码实现</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A1%B9%E7%9B%AE%E9%83%A8%E7%BD%B2"><span class="nav-number">2.6.</span> <span class="nav-text">项目部署</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A1%B9%E7%9B%AE%E6%89%93%E5%8C%85"><span class="nav-number">2.6.1.</span> <span class="nav-text">项目打包</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B1%9E%E6%80%A7%E9%85%8D%E7%BD%AE"><span class="nav-number">2.6.2.</span> <span class="nav-text">属性配置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%9A%E7%8E%AF%E5%A2%83%E5%BC%80%E5%8F%91"><span class="nav-number">2.6.3.</span> <span class="nav-text">多环境开发</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%8D%E4%B9%A0%E4%B8%80%E4%B8%8B%E5%89%8D%E7%AB%AF"><span class="nav-number">3.</span> <span class="nav-text">复习一下前端</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#js%E5%AF%BC%E5%85%A5%E5%AF%BC%E5%87%BA"><span class="nav-number">3.1.</span> <span class="nav-text">js导入导出</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#element-plus%E4%BD%BF%E7%94%A8"><span class="nav-number">3.2.</span> <span class="nav-text">element-plus使用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%A7%E4%BA%8B%E4%BB%B6%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91"><span class="nav-number">4.</span> <span class="nav-text">大事件前端开发</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%89%8D%E6%9C%9F%E5%87%86%E5%A4%87"><span class="nav-number">4.1.</span> <span class="nav-text">前期准备</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B3%A8%E5%86%8C-1"><span class="nav-number">4.2.</span> <span class="nav-text">注册</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A1%B5%E9%9D%A2%E6%90%AD%E5%BB%BA"><span class="nav-number">4.2.1.</span> <span class="nav-text">页面搭建</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A"><span class="nav-number">4.2.2.</span> <span class="nav-text">数据绑定</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A1%A8%E5%8D%95%E6%A0%A1%E9%AA%8C"><span class="nav-number">4.2.3.</span> <span class="nav-text">表单校验</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8E%A5%E5%8F%A3%E8%B0%83%E7%94%A8"><span class="nav-number">4.2.4.</span> <span class="nav-text">接口调用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98"><span class="nav-number">4.2.5.</span> <span class="nav-text">跨域问题</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%99%BB%E5%BD%95-1"><span class="nav-number">4.3.</span> <span class="nav-text">登录</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A-1"><span class="nav-number">4.3.1.</span> <span class="nav-text">数据绑定</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A1%A8%E5%8D%95%E6%A0%A1%E9%AA%8C-1"><span class="nav-number">4.3.2.</span> <span class="nav-text">表单校验</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8E%A5%E5%8F%A3%E8%B0%83%E7%94%A8-1"><span class="nav-number">4.3.3.</span> <span class="nav-text">接口调用</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%BB%E9%A1%B5%E9%9D%A2%E6%90%AD%E5%BB%BA%E5%92%8C%E8%B7%AF%E7%94%B1"><span class="nav-number">4.4.</span> <span class="nav-text">主页面搭建和路由</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%BB%E9%A1%B5%E9%9D%A2%E6%90%AD%E5%BB%BA"><span class="nav-number">4.4.1.</span> <span class="nav-text">主页面搭建</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%B7%AF%E7%94%B1%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="nav-number">4.4.2.</span> <span class="nav-text">路由的基本使用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AD%90%E8%B7%AF%E7%94%B1"><span class="nav-number">4.4.3.</span> <span class="nav-text">子路由</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E7%AB%A0%E5%88%86%E7%B1%BB"><span class="nav-number">4.5.</span> <span class="nav-text">文章分类</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%87%E7%AB%A0%E5%88%86%E7%B1%BB%E5%88%97%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="nav-number">4.5.1.</span> <span class="nav-text">文章分类列表查询</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#pinia%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%E5%BA%93"><span class="nav-number">4.5.2.</span> <span class="nav-text">Pinia状态管理库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#axios%E8%AF%B7%E6%B1%82%E6%8B%A6%E6%88%AA%E5%99%A8"><span class="nav-number">4.5.3.</span> <span class="nav-text">axios请求拦截器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#pinia%E6%8C%81%E4%B9%85%E5%8C%96%E6%8F%92%E4%BB%B6persist"><span class="nav-number">4.5.4.</span> <span class="nav-text">Pinia持久化插件：persist</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%AA%E7%99%BB%E5%BD%95%E7%BB%9F%E4%B8%80%E5%A4%84%E7%90%86"><span class="nav-number">4.5.5.</span> <span class="nav-text">未登录统一处理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B7%BB%E5%8A%A0%E6%96%87%E7%AB%A0%E5%88%86%E7%B1%BB"><span class="nav-number">4.5.6.</span> <span class="nav-text">添加文章分类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BC%96%E8%BE%91%E6%96%87%E7%AB%A0%E5%88%86%E7%B1%BB"><span class="nav-number">4.5.7.</span> <span class="nav-text">编辑文章分类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E6%96%87%E7%AB%A0%E5%88%86%E7%B1%BB"><span class="nav-number">4.5.8.</span> <span class="nav-text">删除文章分类</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E7%AB%A0"><span class="nav-number">4.6.</span> <span class="nav-text">文章</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%87%E7%AB%A0%E5%88%97%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="nav-number">4.6.1.</span> <span class="nav-text">文章列表查询</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B7%BB%E5%8A%A0%E6%96%87%E7%AB%A0"><span class="nav-number">4.6.2.</span> <span class="nav-text">添加文章</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A1%B6%E9%83%A8%E5%AF%BC%E8%88%AA%E6%A0%8F%E4%B8%AA%E4%BA%BA%E4%BF%A1%E6%81%AF"><span class="nav-number">4.7.</span> <span class="nav-text">顶部导航栏个人信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%AA%E4%BA%BA%E4%B8%AD%E5%BF%83"><span class="nav-number">4.8.</span> <span class="nav-text">个人中心</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#el-dropdown%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0"><span class="nav-number">4.8.1.</span> <span class="nav-text">el-dropdown功能实现</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E8%B5%84%E6%96%99%E4%BF%AE%E6%94%B9"><span class="nav-number">4.8.2.</span> <span class="nav-text">基本资料修改</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E5%A4%B4%E5%83%8F"><span class="nav-number">4.8.3.</span> <span class="nav-text">修改头像</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Downey"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Downey</p>
  <div class="site-description" itemprop="description">大杯牛乳红茶 去冰 三分糖</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">30</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">43</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/1354478648" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;1354478648" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:t13544786448@gmail.com" title="E-Mail → mailto:t13544786448@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/zh-CN" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://space.bilibili.com/208947807" title="https:&#x2F;&#x2F;space.bilibili.com&#x2F;208947807" rel="noopener" target="_blank">我的B站主页</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://steamcommunity.com/id/1354478648/" title="https:&#x2F;&#x2F;steamcommunity.com&#x2F;id&#x2F;1354478648&#x2F;" rel="noopener" target="_blank">我的Steam主页</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://dnf.doyi.online/" title="https:&#x2F;&#x2F;dnf.doyi.online&#x2F;" rel="noopener" target="_blank">东南dnf的博客</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://lray-iu.ink/" title="http:&#x2F;&#x2F;lray-iu.ink&#x2F;" rel="noopener" target="_blank">RayBoKi的博客</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Downey</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">679k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">20:35</span>
</div>
  <div class="powered-by">
    <!--由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动 -->
  </div>

<!-- 网站运行时间的设置 -->
<span id="timeDate">载入天数...</span>
<span id="times">载入时分秒...</span>
<script>
    var now = new Date();
    function createtime() {
        var grt= new Date("10/08/2023 12:00:00"); //此处修改你的建站时间或者网站上线时间
        now.setTime(now.getTime()+250);
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;}
        document.getElementById("timeDate").innerHTML = "本站已安全运行 "+dnum+" 天 ";
        document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒.";
    }
setInterval("createtime()",250);
</script>
        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>
  

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
